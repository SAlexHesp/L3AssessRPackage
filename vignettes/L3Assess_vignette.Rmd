---
title: "L3Assess_vignette"
output: 
  rmarkdown::html_vignette:
  #rmarkdown::word_document:
    toc: true
    toc_depth: 3
vignette: >
  %\VignetteIndexEntry{L3Assess_vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


```{r library_setup}
library(L3Assess)
Fig_Path = "C:/~/L3AssessPackage/vignettes/"
```

# Introduction
#### Last updated January 2025 (Alex Hesp - DPIRD)

This package is intended as a toolbox of methods with analyses for conducting "level 3" assessments in Western Australia. These methods are typically "equilibrium" approaches, used when size and/or age data are available, together with information on various biological attributes of species, such as estimates of natural mortality, growth and maturity.  

Typically, a level 3 assessment, as considered by DPIRD in Western Australia, involves producing a "catch curve" estimate of average 'long term' fishing mortality fitted to age or length composition data. The long-term 'fishing mortality' is either estimated directly, or indirectly from total mortality and natural mortality. Some catch curve methods also produce age or length-based estimates of selectivity.  

The catch curve estimates of fishing mortality are often compared to estimates of natural mortality to inform about the (long-term average) level of fishing pressure the stock has experienced. Note that catch curve (equilibrium) estimates of fishing mortality typically pertain to the average value experience over the lifespans of all fish in the sample, and may not correspond to recent mortality (i.e. as the stock may not in equilibrium with respect to mortality and other factors, e.g. recruitment).  

The estimates of 'fishing mortality' and selectivity may be used, in combination with other biological information (e.g. growth, maturity etc,) in per recruit analysis to calculate measures of population reproductive potential, such as spawning potential ratio (SPR). Per recruit analysis may be extended from the traditional form to include a stock-recruitment relationship, to account for potential impacts of fishing pressure on recruitment (i.e. through impacts on spawning stock levels). The estimates of spawning potential ratio (or relative female biomass, from extended per recruit analysis) are used as a proxy for female spawning biomass.  

The estimates of 'fishing mortality', from catch curve analysis, female spawning potential ratio and relative female spawning biomass from per recruit analysis, may be compared against various commonly-used points relating to fishing pressure (e.g. $F_\mathrm{targ}=2/3$, $F_\mathrm{thresh}=M$, $F_\mathrm{lim}=3/2M$) and female spawning stock levels ($B^\mathrm{rel}_\mathrm{targ}=0.4$, $B^\mathrm{rel}_\mathrm{thresh}=0.3$, $B^\mathrm{rel}_\mathrm{lim}=0.2$). The threshold levels are taken as proxies for long-term levels of fishing and biomass expected to yield maximum sustainable yield. Note, however, that if (in particular) the 'steepness' of the stock recruitment relationship is lower than typical for marine broadcast spawning fishes (~0.75), which would be indicative of lower stock productivity (e.g. some shark species), then the values of the reference points would need to be more conservative. 

The package contains several age- and length-based routines for catch curve analysis, per recruit analysis, and an "extended" form of per recruit analysis with a stock-recruitment relationship. It also contains an analysis for calculating length-based selectivity given estimates of selectivity parameters for fish caught by gillnet fishing. 

Several data simulation routines have been implemented for model testing. The include length and/or age generation from equilibrium population models, and more sophistiated dynamic modelling approaches, allowing for a specified history of exploitation and level of annual recruitment variation. 

Please note that this is a 'trial version' with testing of the various routines continuing. Please report any identified issues to Alex Hesp ($\mathrm{Alex.Hesp@dpird.wa.gov.au}$).

## Age-based catch curve methods

### Chapman and Robson (1960) mortality estimator

$$
\hat{Z} = \ln\bigg[1+\overline{X}-\frac{1}{n}\bigg]^{-1}-\ln\overline{X}-\bigg[\frac{{(n-1)(n-2)}}{n(t+1)(n+t-1)}\bigg]
$$
where $\overline{X}$ is the mean age above the age at full recruitment into the fishery, $n$ is the sample size and $t=n\overline{X}$.

An approximate estimate of the variance of $Z$ (for large sample sizes) may be determined as

$$
\hat{\sigma}^2 = \bigg[\frac{(1-\exp(\hat{Z}))^2}{n\exp(\hat{Z}))}\bigg]
$$
see Smith et al. (2012). Thus, an approximate 95% confidence interval for $Z$ may be calculated as $1.96\sigma$. Alternatively, 95% confidence intervals for $Z$ are calculated using resampling with replacement (bootstrapping). The resampling procedure involves producing a specified number (500) random age frequency data sets, and applying the  calculating Chapman and Robson (1960) mortality formula to each of these to produce 500 estimates for $Z$. The point estimate for $Z$, from resamping, is taken as the median of the 500 calculated values for $Z$, and the lower and upper 95 confidence limits as the 2.5 and 97.5 percentiles, respectively. For visualisation, the resampling procedure is also used to produce estimated frequencies of fish at age (above the age at full selection) with associated 95% confidence limits, based on the survival function, i.e.

$$
\hat{N_t} = N_0\exp(-Zt)
$$
where, for a given random data set, $\hat{N_t}$ is the estimated number at relative age $t$, $N_0$ is the observed number of fish at the calculated recruitment age (determined from the original data set), at $t$ is relative age. The observed and estimated frequencies at age can be visualised in normal or log space (for comparison with other age-based catch curve methods).


#### Apply the Chapman and Robson (1960) mortality estimator

Key functions relevant to applying this method are:
GetChapmanRobsonMortalityResults()  
PlotAgeBasedCatchCurveResults_NormalSpace()  
PlotAgeBasedCatchCurveResults_LogSpace()  
Refer to help files and example code, showing function inputs and outputs.


### Linear catch curve analysis

Applying linear catch curve analysis

$$
\begin{align}
    \log_e(N_t) = \log_e(N_0)-Z_t\\
\end{align}
$$
where $N_t$ represents the numbers of fish in the population at time $t$ and $N_0$ is the initial recruitment (e.g. Haddon, 2011). The value for total mortality, $Z_t$, is taken as the negative of the slope of the line. It is assumed that the catch of fish at age $t$ is proportional to the number of fish in the population at that age, and that the population is at equilibrium with respect to mortality and recruitment. The model is fitted using the lm function in R, applying the predict function to estimate 95% confidence limits for the fitted line. Approximate 95% confidence intervals for $Z$ are be calculated as $1.96\sigma$, where $\sigma$ is the estimate of the standard error for $Z$ produced by the lm function. For visualisation, the predict function in R is used to produce estimated frequencies of fish at age (above the age at full selection) with associated approximate 95% confidence limits, 

#### Apply linear catch curve anlaysis

Key functions relevant to applying this method are:  
GetLinearCatchCurveResults()  
PlotAgeBasedCatchCurveResults_NormalSpace()  
PlotAgeBasedCatchCurveResults_LogSpace()  
Refer to help files and example code, showing function inputs and outputs.

### Catch curve analysis with logistic selectivity

This age-based catch curve model assumes estimates multiple parameters, including fully-selected fishing mortality and logistic selectivity parameters. The model can allow for sex-specific differences in age-based selectivity if fitted simultaneously to sex-specific age composition data sets, otherwise selectivity can be assumed to be common to both sexes. Selectivity at age for sex $s$, is calculated as

$$
V_{a,s} = 1/(1+\exp(-\log_e(19)(a-A_{50,s})/(A_{95,s}-A_{50,s})))
$$
  
where $A_{50,s}$ and $A_{95,s}$ are the ages at which 50 and 95% of fish of sex $s$ are selected into the fishery. Fishing mortality at age for sex $s$, $F_{a,s}$, is calculated as 
$$
F_{a,s} = V_{a,s}F
$$
where $F$ is the fully-selected fishing mortality. Total mortality at age for sex $s$, $Z_{a,s}$, is
$$
Z_{a,s} = F_{a,s}+M
$$
The instantaneous rate of natural mortality, $M$, may be calculated, for example, from an empirical equation such as that of Hoenig's (1983) equation for fish, i.e.
$$
M = \exp(1.46)-(1.01)\log_e(A_{\mathrm{max}})
$$
where $A_{max}$ is the observed maximum age for the species. Setting survival at age zero, $N_{a=0}$, to 1, and treating age $A$ as a 'plus group', the expected number of survivors per recruit for each age is

$$
\begin{align}
    N_{a,s} = N_{a-1,s}\exp(-Z_{a-1,s}) && \text{if a<A}\\
    N_{a,s} = N_{a-1,s}\exp(-Z_{a-1,s})/(1-\exp(-Z_{a,s})) && \text{if a=A}\\
\end{align}
$$

where $Z$ is the value of total mortality for fully selected fish and $A$ is the maximum age considered by the model. $C_a$, the catch at age $a$, may be calculated using the Baranov catch equation, i.e.
$$
C_{a,s} = N_{a,s}\biggl(\frac{F_{a,s}}{Z_{a,s}}\biggr)(1-\exp(-Z_{a,s}))
$$
The expected catch proportion at age for sex $s$, $\tilde{\pi}_{a,s}$, is thus
$$
\tilde{\pi}_{a,s} = \frac{C_{a,s}}{\sum_{a=0}^{A}C_{a,s}}
$$
The catch curve may be fitted employing the traditional multinomial log-likelihood or Dirichlet-multinomial log-likelihood. Following similar notation to Thorson et al. (2017) for these likelihood functions, the former may be calculated as
$$
\lambda = \sum_{s=1}^{2}\sum_{a=0}^{A}f_{a,s}\log_e(\tilde{\pi}_{a,s})
$$
where $f$ is the observed frequency at age $a$. The Dirichlet multinomial likelihood is implemented according to the 'linear effective sample size' parameterisation, as recommended in Thorson et al. (2017), whereby an effective sample size, $f_{eff}$, is calculated as

$$
n_{eff}=n\frac{\theta}{1+\theta}
$$
Above, $\theta$ is the variance inflation parameter, estimated when fitting the model, and $n$ is the total number of observations. Following Thorson et al. (2017), the Dirichlet-multinomial log-likelihood, intended to be used to account for over-dispersion in the data (due to lack of statistical independence of sampled fish) and provide more realistic estimates of error, is calculated as

$$
\lambda =\frac{\Gamma(n+1)}{\prod_{a=1}^{A}\Gamma(n|\tilde{\pi}_{a,s}+1)}\frac{\Gamma({\theta}n)}{\Gamma({n+\theta}n)}  \prod_{a=1}^{A}\frac{\Gamma(n|\tilde{\pi}_{a,s}+\theta{n\pi_{a,s}})}{(\theta{n}\pi_{a,s})}
$$

The model is fitted by minimising the negative log-likelihood using nlminb in R, by estimating the fully-selected fishing mortality $F$, and selectivity parameters, $A_{50,s}$ and $A_{95,s}$. Estimates of asymptotic standard errors, $\sigma$, for each of the model parameters, are derived from the variance-covariance matrix (i.e. from the inverted Hessian matrix produced by nlminb). Approximate 95% confidence intervals for the estimated parameters are calculated as $1.96\sigma$. 

For visualisation, model estimates of the frequency of fish at each age, with associated 95% confidence intervals, are calculated using a parametric resampling approach, assuming the estimated model parameters conform to a multivariate normal distribution. The mvrnorm function within the MASS package is used together with the values of the estimated model parameters and associated variance-covariance matrix to generate 500 random values of each of the model parameters. These, in turn, are used to produce 500 sets of model estimates for the frequency of fish at each age, $\tilde{f_a}$, calculated as

$$
\tilde{f_a}=\tilde{\pi}_an
$$

where $n$ is the observed sample size. The lower and upper 95 confidence limits for $\hat{f_a}$ are taken as the 2.5 and 97.5 percentiles of the 500 estimates for $\hat{f_a}$, respectively. 


#### Apply catch curve analysis with logistic selectivity

Key functions relevant to applying this method are:  
GetLogisticCatchCurveResults()  
PlotAgeBasedCatchCurveResults_NormalSpace()  
PlotAgeBasedCatchCurveResults_LogSpace()  
Refer to help files and example code, showing function inputs and outputs.

## Length-based selectivity analysis

### Gillnet selectivity - Kirkwood and Walker (1986)

The Kirkwood & Walker (1986) model describes selectivity as a function of fish length and two parameters for the probability density function of the gamma distribution, $\theta_1$ and $\theta_2$.  

According to this model, the relative selectivity of a fish in length class $j$ caught in mesh size $i$ is calculated as
$$
\begin{align}
    S_{ij} =\bigg(\frac{L_j}{\alpha_i\beta_i}\bigg)^{\alpha_i}\exp\bigg(\alpha-\frac{L_j}{\beta} \bigg)
\end{align}
$$
where $Lj$ is the midpoint of length class $j$, and $\alpha_i$ and $\beta_i$ are the parameters of the gamma distribution determined for mesh size $m_i$. The values of $\alpha_i$ and $\beta_i$ may be calculated from $m_i$, $\theta_1$, a dimensionless scaling parameter used to relate the mode of the gamma distribution $(\alpha,\beta)$ to mesh size and from the variance $(\theta_2)$, with
$$
\begin{align}
    \alpha_i\beta_i=\theta_1m_i
\end{align}
$$
and
$$
\begin{align}
    \beta_i=-0.5(\theta_1m_i-(\theta_2^2m_i^2+4\theta_2)^{0.5})
\end{align}
$$
An estimate of the relative proportion of fish in the population in length class $j$ may be calculated as

$$
\begin{align}
    \hat\mu_j=\frac{\sum_{i=1}^{I}n_{ij}}{\sum_{i=1}^{I}S_{ij}}
\end{align}
$$
where $n_ij$ is the number of fish in length class $j$ caught in mesh size $i$. The relative selectivity of fish in the multi-mesh research gill net in length class $j$ is estimated as

$$
\begin{align}
    P_j=\frac{\sum_{i=1}^{I}S_{ij}}{\max\sum_{i=1}^{I}S_{ij}}
\end{align}
$$
e.g. Hansen et al. (1997). The negative log-likelihood associated with the values of model parameters ($\theta_1$ and $\theta_2$) and observed sample length frequency data (for each mesh), is 

$$
\begin{align}
    \lambda=\sum_{i=1}^{I}\sum_{j=1}^{J}[n_{ij}\log_e(\mu_jS_{ij})-\mu_jS_{ij}]
\end{align}
$$
An important assumption of this implementation of the Kirkwood & Walker (1986) model is that, at the size of maximum selectivity, the different meshes to which the model is fitted have equal fishing power.


### Apply gillnet selectivity - Kirkwood and Walker (1986)

Key functions relevant to applying this method are:  
CalcGillnetSelectivity()  
GetGillnetSelectivityResults()  
Refer to help files and example code, showing function inputs and outputs.

## Length-based catch curve methods

### Length-based catch curve (LBCC)

This sex-structured length-based catch curve approach allows for common or divergent growth between the two sexes and growth variation (by applying sex-specific length-transition matrices). Selectivity, fully-selected fishing mortality (and natural mortality) are assumed to be common to both sexes. Growth can be based on either a von Bertalanffy growth curve or Schnute growth curve. The approach involves calculating expected survival and catches for each sex, per recruit, given specified values for natural mortality, growth parameters (and associated variation), weight-at-length parameters, and model parameters for selectivity and fishing mortality. A mathematical description of this model, and results of simulation testing, are available Crisafulli et al (2025), and supplementary material for that paper. 

#### Growth calculations - length-based catch curve

Assuming a von Bertalanffy growth curve, the expected length of fish of sex $s$ at age $a$ is

$$
L_{s,a} = L_{s,\infty} \left( 1 - \exp \left( -\kappa_s (a - t_{s,0}) \right) \right)
$$
where $L_{s,\infty}$, $\kappa_s$ and $t_{s,0}$ are the asymptotic length, growth coefficient and hypothetical age at zero length, for sex $s$. For alternative equations using the Schnute growth function, see description below for length-based equilibrium analysis (LBEA). 

The proportion ($\theta_{s,k} \approx 1$) of sex $s$, in length class $k$ at age $a = 1$, assuming a normal distribution, with variance $\sigma^2$, around the expected length ($\mu_s$), as calculated above from the von Bertalanffy growth equation (or from a Schnute growth equation). That is, 


$$
\theta_{s,k} \propto \frac{1}{\sqrt{2\pi\sigma^2}} \int_{L_k^-}^{L_k^+} \exp \left( -\frac{(l_s - \mu_s)^2}{2\sigma^2} \right) dl_s
$$
where $l_s$ refers to a given length for fish of sex $s$. The constant of proportionality is chosen to satisfy the constraint that $\sum_{k=1}^K \theta_{s,k} = 1$. $\Delta L_{s,k}$. The mean annual growth increment for fish of sex $s$ in length class $s$ is calculated as

$$
\Delta L_{s,k} = L_{\infty,s} - L_k \left( 1 - \exp \left( -\kappa_s \right) \right)
$$
where $L_k$ denotes the midpoint of length class $k$. Elements of the (sex-specific) length transition matrices (Punt et al., 1997), describing the probability of fish of sex $s$, in length class $k$ moving into length class $j$ are calculated as

$$
g_{s,j,k} = 
\begin{cases} 
0 & \text{if } j < k \\
\propto \frac{1}{\sqrt{2\pi\sigma^2}} \int_{L_k^-}^{L_k^+} \exp \left( -\frac{(l - (L_k + \Delta L_{s,k}))^2}{2\sigma^2} \right) dl & \text{if } j = k \\
\propto \frac{1}{\sqrt{2\pi\sigma^2}} \int_{L_j^-}^{L_j^+} \exp \left( -\frac{(l - (L_k + \Delta L_{s,k}))^2}{2\sigma^2} \right) dl & \text{if } j > k
\end{cases}
$$
The sex-specific length transition matrices $\textbf{G}_s$ are of the following form, noting that the elements ($g_{s,j,k}$) in each column of the sex-specific length transition matrix sum to 1

$$
\textbf{G}_s = [g_{s,j,k}]=\begin{pmatrix}
g_{s,1,1} & 0 & \cdots & 0 & 0 \\
g_{s,2,1} & g_{s,2,2} & \cdots & 0 & 0 \\
\vdots & \vdots & \ddots & \vdots & \vdots \\
g_{s,K-1,1} & g_{s,K-2,2} & \cdots & g_{s,K-1,K-1} & 0 \\
g_{s,K,1} & g_{s,K,2} & \cdots & g_{s,K,K-1} & g_{s,K,K}
\end{pmatrix}
$$

### Selectivity of fishing gear, retention and discarding - length-based catch curve

A 'retention function' approach is used to account for the possibility of 'discard mortality' (Fairclough et al., 2021; Shertzer et al., 2021). The vulnerability of fish in length class $k$ to the fishing gear, $V_k$, is calculated as

$$
V_k = 1/(1+\exp(-\log_e(19)(L_k-L_{50}^{\mathrm{V}})/(L_{95}^{\mathrm{V}}-L_{50}^{\mathrm{V}})))
$$
where $L_{50}^{\mathrm{V}}$ and $L_{95}^{\mathrm{V}}$ are the lengths at which 50 and 95% of fish are selected by the gear. Note that, for more robust optimisation, $L_{95}^{\mathrm{V}}-L_{50}^{\mathrm{V}}$ is inputted by the user as a single value. Similarly, the probability of fish in length class $k$ being retained, by default, is calculated as

$$
\psi_k = 1/(1+\exp(-\log_e(19)(L_k-L_{50}^{\mathrm{\psi}})/(L_{95}^{\mathrm{\psi}}-L_{50}^{\mathrm{\psi}})))
$$
If a minimum legal length (MLL) does not apply and all fish are assumed to be retained, $\psi_k$ may set by the user to one for all lengths. If an MLL applies and all fishers are assumed to comply with this regulation and high-grading of fish does not occur, $$\psi_k$$ can be set to be 'knife edged', by specifying zero or one, depending on whether the midpoint of its length class is below or above the MLL, respectively. The selectivity of landings, $\phi_k$, for fish in length class $k$, is calculated as

$$
\phi_k = \psi_k V_k
$$
The selectivity of discarding, $D_k$, is calculated as

$$
D_k = 1 - \psi_k V_k
$$

### Fishing mortality - length-based catch curve

The fishing mortality of fish in length class $k$ allowing for post release mortality, $F_k$, is

$$
F_k = \phi_k + D_k \delta F
$$
where $\delta$ is the specified proportion of fish that die following capture and release. For model scenarios not concerned with post-release mortality, $\delta$, should be set to zero. The fishing mortality of fish in length class $k$ associated with retention, $F_k^R$, is

$$
F_k^R = \phi_k F
$$
Total mortality for fish in length class $k$ is

$$
Z_k = F_k + M
$$
where $M$ is the instantaneous rate of natural mortality ($y^{-1}$).

#### Survival and catch calculations - length-based catch curve

The proportion of fish of sex $s$ and length class $k$ surviving in age $a$ is 

$$
S_{s,k,a} = 
\begin{cases} 
\exp(-Z_k) & \text{if } 1 \le a < A \\
\exp(-Z_k) / (1 - \exp(-Z_k)) & \text{if } a = A 
\end{cases}
$$
where $A$ is the maximum age considered by the model. The sex and age-specific survival matrix is

$$
\textbf{S}_{s,a} = [S_{s,k,a}]= \begin{pmatrix}
S_{s,1,a} & 0 & \cdots & 0 & 0 \\
0 & S_{s,2,a} & \cdots & 0 & 0 \\
\vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & \cdots & S_{s,K-1,a} & 0 \\
0 & 0 & \cdots & 0 & S_{s,K,a}
\end{pmatrix}
$$

The numbers of fish of sex $s$ in the exploited population surviving to age $a$ is 
$$
N_{s,a} = 
\begin{cases} 
R_s & \text{if } a = 1 \\
G_s S_{s,a-1} N_{s,a-1} & \text{if } 1 < a \le A 
\end{cases}
$$
where recruitment, $R_s=0.5$, such that numbers are ‘per recruit’. $R_s$ is a column vector of recruits in the $K$ different length classes, i,e.

$$
R_s = \begin{pmatrix}
\theta_{s,1} \\
\theta_{s,2} \\
\theta_{s,3} \\
\vdots \\
\theta_{s,K}
\end{pmatrix}
$$
The numbers of fish of sex $s$ are represented by a the following number matrix, 

$$
\textbf{N}_s = [N_{s,k,a}] = \begin{pmatrix}
N_{s,1,1} & N_{s,1,2} & \cdots & N_{s,1,A-1} & N_{s,1,A} \\
N_{s,2,1} & N_{s,2,2} & \cdots & N_{s,2,A-1} & N_{s,2,A} \\
\vdots & \vdots & \ddots & \vdots & \vdots \\
N_{s,K-1,1} & N_{s,K-1,2} & \cdots & N_{s,K-1,A-1} & N_{s,K-1,A} \\
N_{s,K,1} & N_{s,K,2} & \cdots & N_{s,K,A-1} & N_{s,K,A}
\end{pmatrix}
$$
the elements of which ($N_{s,k,a}$) are the numbers of fish of sex $s$ in length class $k$ and age $a$, in the population at equilibrium with constant recruitment, mortality and growth. The number of fish of sex $s$ in length class $k$ is thus

$$
N_{s,k} = \sum_{a=1}^A N_{s,k,a}
$$
The estimated numbers of fish of sex $s$ in length class $k$ in retained catches, as calculated from the Baranov catch equation are

$$
C_{s,k}^R = \frac{F_k^R}{Z_k} \left( 1 - \exp(-Z_k) \right) N_{s,k}
$$
The expected proportions of fish in length class $k$ in retained catches for combined sexes is calculated as

#### Objective function calculations - length-based catch curve


$$
P_k^R = \frac{\sum_s C_{s,k}^R}{\sum_k \sum_s C_{s,k}^R}
$$
The multinomial negative log-likelihood associated with the observed length composition data for retained fish is as follows 

$$
\lambda = \sum_k C_k^R \ln \left( P_k^R + 0.0001 \right)
$$
The small constant is used to robustify the calculations.

Note that LBCC may also be fitted simultaneously to size compositions for retained fish and also for fish of sizes that would typically be caught and released during normal fishing operations (e.g. if such fish were measured by researchers during onboard monitoring). In such cases, an additional multinomial likelihood is calculated, associated with the observed and expected length distributions for released fish. The model is then fitted to the summed likelihoods for retained and released fish. LBCC can also be fitted assuming a Dirichlet-multinomial (rather than multinomial distribution). The Dirichlet multinomial distribution has been implemented in the same way as described for the age-based logistic catch curve in L3Assess (see above), i.e. using the 'linear effective sample size' parameterisation, as recommended in Thorson et al. (2017) 


#### Calculation of model diagnostics on proportion of released fish, and mean length of released fish

The estimated numbers of fish of sex $s$ in length class $k$ that are released (that either survive or die) may be calcualted as

$$
C_{s,k}^r = \frac{F_k^r}{Z_k} \left( 1 - \exp(-Z_k) \right) N_{s,k}
$$
where $F_k^r=D_kF$.

The predicted proportion of fish that are caught and then released (which may survive or die), may then be calculated as 

$$
z^r = \Bigg(\frac{\sum_{s}\sum_{k}\hat{C}_{s,k}^{r}}{\sum_{s}\sum_{k}(\hat{C}_{s,k}^R+\hat{C}_{s,k}^{r})}\Bigg)
$$

The mean size of fish that are caught and then released (which may survive or die), may be calculated as

$$
\bar{x}^r = \Bigg(\frac{\sum_s\sum_k\hat{C}_{s,k}^{r}L_k}{\sum_{s}\sum_k\hat{C}_{s,k}^r}\Bigg)
$$

### Estimating uncertainty for model outputs

For visualisation, model estimates of the proportion of fish in each length class, with associated 95% confidence intervals, are also calculated using a parametric resampling approach, assuming the estimated model parameters conform to a multivariate normal distribution. The mvrnorm function within the MASS package is used together with the values of the estimated model parameters and associated variance-covariance matrix to generate 200 random values of each of the model parameters. These, in turn, are used to produce 200 sets of model estimates for the expected proportion of fish in each length class. The lower and upper 95 confidence limits for $\hat{f_a}$ are taken as the 2.5 and 97.5 percentiles of the 200 estimates for $\hat{P}_l$, respectively. 

The equations outlined above are based on a model assuming an annual timestep. LBCC can, however, also allow use of alternative model time step values (e.g. 1/12 of a year vs 1 year). For shorter-lived species (e.g. < 10 y), it is likely better to use a shorter model timestep (if samples are collected at intervals throughout the year), such that the modelled length compositions can more closely match observed data, by allowing fish to grow throughout the year. 

### Apply length-based catch curve

Key functions relevant to applying this method are:  
SimLenAndAgeFreqData()  
GetLengthBasedCatchCurveResults()  
PlotLengthBasedCatchCurve_Selectivity()  
PlotLengthBasedCatchCurve_Mortality()  
PlotLengthBasedCatchCurve_RetCatch()  
PlotLengthBasedCatchCurve_DiscCatch()  
VisualiseGrowthApplyingLTM()  
Refer to help files and example code, showing function inputs and outputs.

## Length and age-based catch curve

This model applies the same set of equations as described above for the length-based catch curve, but is fitted using a modified objective function with two components, the first associated with the marginal length composition (as described above), and the second, with conditional ages-at-length. The approach estimates logistic selectivity parameters ($L_{50}$ and $L_{95}$), von Bertalanffy growth parameters ($L_{\infty,s}$ and $k,s$) and fully-selected fishing mortality ($F^*$). As with the above length-based model, this model is also sex-structured, allowing growth to be estimated simultaneously for both sexes, whilst assuming common length-based selectivity and fully-selected fishing mortality. Single sex data can also be inputted, allowing for growth, selectivity and fishing mortality to be estimated separately for each sex.

Following Piner et al. (2016), the distribution of ages for a given length class is assumed to follow a multinomial distribution. The log-likelihood for ${C}_{l,a}$, the number of fish in the retained catch in length class $l$ at age $a$, is calculated as

$$
\lambda_2=\sum_{s}\sum_{k}\sum_{a}{C}_{s,l,a}\log_e(\hat{P_s}{(a|k)})
$$

In the above equation, $\hat{P_s}(a|k)$ is the expected conditional proportion of fish, of sex $s$, in the catch at age $a$ in length class $k$, which calculated as

$$
\hat{P_s}{(a|k)}=\frac{\hat{P_s}(k|a)\hat{P_s}(a)}{\sum_{a}\hat{P_s}(k|a)\hat{P_s}(a)}
$$
where
$$
\hat{P_s}(a) = \frac{\hat{C}_{s,a}}{\sum_{s,a}\hat{C}_{s,a}}
$$
and 

$$
\hat{P_s}(k|a) = \frac{\hat{C}_{s,k,a}}{\sum_{k}\hat{C}_{s,k,a}}
$$
The overall log-likelihood is calculated as the sum of the log-likelihoods associated with the marginal length composition, $\lambda_1$ (as described above for the length-based catch curve method) and the conditional age at length log-likelihood, $\lambda_2$.

Note that this catch curve routine also allows use of alternative model time step values (e.g. 1/12 of a year vs 1 year). For shorter-lived species (e.g. < 10 y), it is likely more appropriate to use a shorter model timestep (if samples are collected at intervals throughout the year), such that the modelled length compositions more closely match observed data, by allowing fish to grow throughout the year. 

### Apply length and age-based catch curve

Key functions relevant to applying this method are:  
SimLenAndAgeFreqData()  
VisualiseGrowthApplyingLTM()  
GetAgeAndLengthBasedCatchCurveResults()   
PlotAgeLengthCatchCurve_Growth()  
PlotAgeLengthCatchCurve_Selectivity()  
PlotAgeLengthCatchCurve_Cond_AL()  
PlotAgeLengthCatchCurve_MargLength()   
Refer to help files and example code, showing function inputs and outputs.

### Length-converted catch curve (regression approach)

A length-converted catch curve (e.g. see Pauly 1990, 1995), is typically a linear regression, and may be described as 

$$
\begin{align}
    \log_e[N/{\Delta}_t] = a+bt'_{m}
\end{align}
$$
where $N$ is the observed number of fish in a given length class, ${\Delta}_t$ is the time taken for fish to grow through that length class, $a$ is the y intercept, $t'_m$ is the mean (relative) age of fish at the mid-point of that length class. The negative of $b$ equates to total mortality, $Z$. If the growth of the species is described by a von Bertalanffy growth curve, the relative age of fish at the lower bound ($t_{lw}$), upper bound ($t_{up}$) and mid-point of length class $t'_l$, may each be calculated from the inverse von Bertalanffy growth equation, i.e.
$$
\begin{align}
    t'=-(1/k)(\log_e(1-(L_{t'}-L_\infty))
\end{align}
$$

where $t'$ is the relative age, $L_\infty$ and $k$ are the asymptotic length and growth coefficient parameters of the growth curve, and $L_t'$ is the length, at $t'$. In this package, length-converted catch curves may also be calculated for fish with growth described by a Schnute growth curve, for cases where the parameters $a$ and $b$ are not equal to zero. That is, where growth is described as 

$$
L_t=\bigg((y_1^b+(y_2^b-y_1^b))\frac{1-\exp(-a(t-t_1))}{1-\exp(-a(t_2-t_1))}\bigg)^{1/b}
$$
In this case, relative ages may be calculated from the inverse Schnute growth equation as

$$
t'=\frac{\log_e(1-(L_{t'}^b-y_1^b)/(y_2^b-y_1^b)(1-\exp(-a(t_2-t_1))))}{-a+t_1}
$$
In this implementation, using either growth curve model, the values of ${\Delta}_t$ are calculated as 
$$
{\Delta}_t=t_{up}-t_{lw}
$$
The length-converted catch curve model is using the lm() function in R, which outputs estimates of the linear model parameters, i.e. $a$ and $b$, and associated standard errors. Approximate 95% confidence limits for the parameters are calculated as $1.96SE$. Approximate 95% confidence limits for the fitted line, estimated at the midpoint of each length class, are calculated from the outputs of the linear model, using the predict() function.

### Apply length-converted catch curve (regression approach)

Key functions relevant to applying this method are:  
SimLenAndAgeFreqData()  
GetPaulyLenConvCatchCurveResults()  
PlotLenConvCatchCurveResults()  
Refer to help files and example code, showing function inputs and outputs.

## Age-based per recruit analysis

This package implements an age-based per recruit analysis, including several options, some of which represent extensions to traditional per recruit analysis. Some of these options include, variable model timestep options (i.e. allowing for a shorter model time step for shorter-lived species, for more accurate modelling), allowing for post-release mortality (using a 'retention-function' approach), allowing for effects of fishing on recruitment (i.e. by including a stock-recruitment relationship), and  calculations to determine expected relative biomass and fishing mortality levels associated with BMSY reference points.

### Growth and maturity - age-based per recruit analysis

Growth can be modelled according to a von Bertalanffy growth equation (with inputted parameter values), or any other form of growth curve with inputted values for mean length at age. Applying the von Bertalanffy growth euation, the estimated length of fish at age $t$ and sex $s$, $L_{t,s}$ is calculated as

$$
L_{t,s} = L_{\infty,s}(1-\exp(-k_s(t-t_{0,s})))
$$
where $L_{\infty,s}$, $k,_s$ and $t_0,s$ are the is the asymptotic length, growth coefficient hypothetical age at zero length, respectively. The weight of fish at age $t$, $W_t$, in kg, can be inputted as a vector of mean weights at ages, for calculated from inputted paramerer values according to a weight-length relationship, either

$$
W_{t,s}=\exp(a_s+b_s\log_eL_{t,s})/1000
$$
or
$$
W_{t,s}=(a_s L_{t,s}^ {b_s})/1000
$$
where $a_s$ and $b_s$ are the sex-specific weight-length parameters, for a model fitted to weights measured in g and fish lengths measured in mm. The probability of a fish of sex $s$ being mature at age $t$ is calculated as

$$
P_{s,a} = 1/(1+\exp(-\log_e(19)(a-a_{50,s}^{\mathrm{M}})/(a_{95,s}^{\mathrm{M}}-a_{50,s}^{\mathrm{M}})))
$$
where $a_{50,s}^{\mathrm{M}}$ and $a_{95,s}^{\mathrm{M}}$ are the ages at which 50 and 95% of fish are mature, respectively.


### Gear selectivity, retention and discard mortality - age-based per recruit analysis

The model employs a 'retention function' approach to account for such 'discard mortality' (Fairclough et al., 2021; Shertzer et al., 2021). Applying this approach, the vulnerability of fish of sex $s$ and age $a$ to the fishing gear. $V_{s,a}$ is calculated as

$$
V_{s,a} = 1/(1+\exp(-\log_e(19)(a-a_{50,s}^{\mathrm{V}})/(a_{95,s}^{\mathrm{V}}-a_{50,s}^{\mathrm{V}})))
$$

where $a_{50,s}^{\mathrm{V}}$ and $a_{95,s}^{\mathrm{V}}$ are the ages at which 50 and 95% of fish of sex $s$ are selected by the gear. $\psi_{s,a}$, the probability of a fish (during normal fishing operations) of either sex at age $t$ being retained (i.e. retention ogive) at age $a$, is calculated as

$$
\psi_{s,a} = 1/(1+\exp(-\log_e(19)(a-a_{50,s}^{\mathrm{\psi}})/(a_{95,s}^{\mathrm{\psi}}-a_{50,s}^{\mathrm{\psi}})))
$$
where $a_{50,s}^{\mathrm{\psi}}$ and $a_{95,s}^{\mathrm{\psi}}$ are the ages at which 50 and 95% of fish of sex $s$ are retained. 

The selectivity of fish landings, $\phi_{s,a}$ for sex $s$ and age $a$ is calculated as

$$
\phi_{s,a}=\psi_{s,a}V_{s,a}
$$
The selectivity of discarding is calculated as

$$
\delta{s,a}=V_{s,a}(1-\psi_{s,a})
$$

### Fishing mortality - age-based per recruit analysis

For model scenarios not allowing for post-release mortality of undersize fish, the proportion of fish that die following capture and release, $D$, is set to zero. In such cases, the annual fishing mortality associated with capture and retention of fish of sex $s$ at age $t$ is calculated as

$$
F_{s,t}=\psi_{s,a}F
$$
where $F$ is the fully-selected fishing mortality. Conversely, for model scenarios allowing for post-release mortality (i.e. $D>0.01$), $F_{s,a}$ is calculated as

$$
F_{s,a} = (\phi_{s,a}+\delta_{s,a}D)F
$$
where $\phi_{s,a}$ and $\delta{s,a}$ are the selectivity of fish landings and fish discards, respectively, for fish of sex $s$ and age $a$. The fishing mortality of fish of sex $s$ at the midpoint at age $a$ associated with retention, $F_{s,a}^R$ is calculated as

$$
F_{s,a}^R=\phi_{s,a}F
$$


Total mortality for fish of sex $s$ at age $t$ is calculated as 

$$
Z_{s,a} = F_{s,a}+M
$$
where $M$ is the instantaneous rate of natural mortality ($y^-1$).


### Yield per recruit - age-based per recruit analysis

Yield per recruit, $YPR$, is calculated as
$$
YPR = \sum_{s=1}^{2}\sum_{a=0}^{A}C_{s,a}W_{s,a}
$$
where the catch of fish of sex $s$ at age $a$, i.e. $C_{s,a}$, is calculated from the Baranov catch equation.
$$
C_{s,a} = N_{s,a}\biggl(\frac{F_{s,a}^R}{Z_{s,a}}\biggr)(1-\exp(-Z_{s,a}))
$$
In the above equation, $N_s,a$, i.e. the numbers of sex $s$ at age $a$, for the fished population are calculated as
$$
\begin{align}
    N_{s,a} = \xi && \text{if s=1 and a=0}\\
    N_{s,a} = 1-\xi && \text{if s=2 and a=0}\\
    N_{s,a} = N_{s,a-1}\exp(-Z_{s,a-1}) && \text{if 0<a<A}\\
    N_{s,a} = N_{s,a-1}\exp(-Z_{s,a-1})/(1-\exp(-Z_{s,a-1})) && \text{if a=A}\\
\end{align}
$$
where $\xi$ is the ratio of females to males at age 0 yr, and $A$, is the maximum age considered by the model. The numbers of sex $s$ at age $a$ for the unfished population, $\acute{N}_{s,a}$ are calculated as above for $N_{s,a}$, but replacing all values for total mortality with natural mortality, $M$. 

If the species is a protogynous hermaphrodite (female to male sex change), the proportion of females at age is assumed to remain constant, described by the following inverse logistic relationship 

$$
\rho_{a} = 1-\bigg[P_{max}^{s=2}/(1+\exp(-\log_e(19)(a-a_{50}^{\rho})/(a_{95}^{\rho}-a_{50}^{\rho})))\bigg]
$$
where $P_{max}^{s=2}$ is the maximum proportion for the terminal sex (males) and $a_{50}^{\rho}$ and $a_{95}^{\rho}$ are the ages at which 50 and 95% of $P_{max}^\rho$ are males. For protandrous species (male to female sex change), $\rho_{a}$ is calculated as
$$
\rho_{a} = P_{max}^{s=1}/(1+\exp(-\log_e(19)(a-a_{50}^{\rho})/(a_{95}^{\rho}-a_{50}^{\rho})))
$$
where $P_{max}^{s=1}$, the terminal sex, is females. For hermaphroditic species, the values of $N_{s,a}$ become modified, prior calculation of survival at the next age step, to reflect the assumed sex ratios at age. The modified values for female, $N'_{s=1,a}$ are calculated as

$$
N'_{s=1,a}=\rho_{a}(N_{s=1,a}+N_{s=2,a})
$$
and those for males as
$$
N'_{s=1,a}=(1-\rho_{a})(N_{s=1,a}+N_{s=2,a})
$$


### Spawning potential ratio - age-based per recruit analysis

Spawning biomass per recruit for sex $s$ when population is at equilibrium with fully-selected fishing mortality, $F$, is

$$
\Phi_{s,F} = \sum_{a=0}^A N_{s,a} W_{s,a} P_{s,a}
$$

The spawning potential ratio, for sex $s$ when the population is at equilibrium with fully-selected fishing mortality, $F$, is
$$
SPR_{s,F} = \frac{\Phi_{s,F}}{\Phi_{s,F=0}}
$$



### Apply age-based per recruit analysis

Key functions relevant to applying this method are:  
CalcYPRAndSPRForFMort_AB()  
GetPerRecruitResults_AB()  
PlotPerRecruitResults_AB()  
PlotPerRecruit_Biom_no_err_AB()  
PlotPerRecruit_Yield_no_err_AB()  
PlotPerRecruit_Param_Err_Distns()  
GetPerRecruitResults_with_err_AB()  
PlotPerRecruit_Biom_with_err_AB()  
PlotPerRecruit_RiskMatrix_RelBiom()  
Refer to help files and example code, showing function inputs and outputs.


## Length-based equilbrium analysis (LBEA)

This package implements an extended form of length-based per recruit analysis, now referred to as length-based equilibrium analysis (LBEA); see Crisafulli et al. (in review), with a range of extensions, one of which is to allow for effects of fishing on recruitment through inclusion of a stock-recruitment relationship (e.g. see Punt et al., 1993). Various options included are i) allowing for post-release mortality (using a 'retention-function' approach), ii) allowing for isometric or hyperallometric scaling of reproductive output (i.e. BOFFFF effects), and iii) allowing for alternative forms of growth curve (Schnute or von Bertalanffy growth model) and iv) calculations to determine expected relative biomass and fishing mortality levels associated with BMSY reference points. Routines are also included to assess effects of fishing mortality on expected sizes of fish catch (fish length and body weight) distributions, and also predict how 'value-per-recruit' changes with exploitation. The equations provided below describe models assuming an annual timestep, although LBEA can also assume a shorter timestep (likely best for shorter-lived species. A number of the model equations are the same as for LBCC but, for completeness, are repeated here. This mathematical description of this model is now also available in the supplementary material for Crisafulli et al (in review).


### Growth - length-based equilbrium analysis (LBEA)

If assuming a von Bertalanffy growth curve, the expected length of fish of sex $s$ at age $a$ is

$$
L_{s,a} = L_{s,\infty} \left( 1 - \exp \left( -\kappa_s (a - t_{s,0}) \right) \right)
$$
where $L_{s,\infty}$, $\kappa_s$ and $t_{s,0}$ are the asymptotic length, growth coefficient and hypothetical age at zero length, for sex $s$. Alternatively, applying a Schnute growth model (with parameters $c$ and $d$ not equal to zero), $L_{t,s}$ is calculated as 

$$
L_{s,a}=\bigg((y_{1,s}^d+(y_{2,s}^d-y_{1,s}^d))\frac{1-\exp(-c_s(a-t_1))}{1-\exp(-c_s(t_2-t_1))}\bigg)^{1/d_s}
$$
where $t_1$ and $t_2$ are specified 'references' ages for estimated lengths $y_{1,s}$ and $y_{2,s}$, at those ages, respectively. 

The proportion ($\theta_{s,k} \approx 1$) of sex $s$, in length class $k$ at age $a = 1$, assuming a normal distribution, with variance $\sigma^2$, around the expected length ($\mu_s$), as calculated above from the relevant growth equation. That is, 

$$
\theta_{s,k} \propto \frac{1}{\sqrt{2\pi\sigma^2}} \int_{L_k^-}^{L_k^+} \exp \left( -\frac{(l_s - \mu_s)^2}{2\sigma^2} \right) dl_s
$$
where $l_s$ refers to a given length for fish of sex $s$. The constant of proportionality is chosen to satisfy the constraint that $\sum_{k=1}^K \theta_{s,k} = 1$. $\Delta L_{s,k}$. The mean annual growth increment for fish of sex $s$ in length class $s$ is calculated as

$$
\Delta L_{s,k} = L_{\infty,s} - L_k \left( 1 - \exp \left( -\kappa_s \right) \right)
$$
where $L_k$ denotes the midpoint of length class $k$. Using the Schnute growth function, $\Delta L_{s,k}$ is calculated i) by determining the mean expected age of fish in length class $k$ (from the inverse Schnute growth equation, if $c$ and $d$ are not equal to zero), ii) calculating the mean expected length for such fish at their expected age for the next model timestep (from the Schnute growth equation), and then iii) calculating the difference between the lengths of fish at the two respective ages. From  the inverse Schnute growth function, the mean age at length $L_{t,s}$ is  
$$
a_k = \ln(1-({L_{s,k}}^d-{y_{1,s}}^d)/({y_{2,s}}^b-{y_{1,s}}^d))(1-\exp(-c(t_2-t_1))))/(-c+t_1)
$$
To robustify analysis employing Schnute growth equations, values of $L_k$ are constrained to not exceed the asymptotic length $L_{\infty,s}$, expected from the Schnute growth equation, i.e.

$$
L_{\infty,s}=((\exp(a.t_2){y_{2,s}}^d-\exp(a.t_1){y_{1,s}}^b)/(\exp(a.t_2)-\exp(a.t_1)))^{1/d}
$$
The elements of the (sex-specific) length transition matrices (Punt et al., 1997), describing the probability of fish of sex $s$, in length class $k$ moving into length class $j$ are calculated as

$$
g_{s,j,k} = 
\begin{cases} 
0 & \text{if } j < k \\
\propto \frac{1}{\sqrt{2\pi\sigma^2}} \int_{L_k^-}^{L_k^+} \exp \left( -\frac{(l - (L_k + \Delta L_{s,k}))^2}{2\sigma^2} \right) dl & \text{if } j = k \\
\propto \frac{1}{\sqrt{2\pi\sigma^2}} \int_{L_j^-}^{L_j^+} \exp \left( -\frac{(l - (L_k + \Delta L_{s,k}))^2}{2\sigma^2} \right) dl & \text{if } j > k
\end{cases}
$$
The sex-specific length transition matrices $\textbf{G}_s$ are of the following form, noting that the elements ($g_{s,j,k}$) in each column of the sex-specific length transition matrix sum to 1

$$
\textbf{G}_s = [g_{s,j,k}]=\begin{pmatrix}
g_{s,1,1} & 0 & \cdots & 0 & 0 \\
g_{s,2,1} & g_{s,2,2} & \cdots & 0 & 0 \\
\vdots & \vdots & \ddots & \vdots & \vdots \\
g_{s,K-1,1} & g_{s,K-2,2} & \cdots & g_{s,K-1,K-1} & 0 \\
g_{s,K,1} & g_{s,K,2} & \cdots & g_{s,K,K-1} & g_{s,K,K}
\end{pmatrix}
$$


$W_l$, the weight of fish of sex $s$ in length class $k$, can be inputted as a vector of mean weights at the midpoints of each length class considered in the model, or calculated from inputted parameter values, according to a weight-length relationship, either

$$
W_{s,k} = \exp(WL_{s,a} + WL_{s,b} \ln L_k) / 1000
$$
or
$$
W_{s,k}=(WL_{s,a}.L_k^ {WL_{s,b}})/1000
$$
where $WL_{s,a}$ and $WL_{s,b}$ are the sex-specific weight-length parameters, for a model fitted to weights measured in g and fish lengths measured in mm. 


### Maturity - length-based equilbrium analysis (LBEA)

The probability of a fish of sex $s$ being mature in length class $k$ is

$$
P_{s,k} = 1/(1 + \exp( -\ln(19) (L_{s,k} - L_{50,s}^M)/(L_{95,s}^M - L_{50,s}^M)))
$$

where $L_{50,s}^M$ and $L_{95,s}^M$ are the lengths at which 50 and 95% of fish are mature, respectively.


### Selectivity of fishing gear, retention and discarding - length-based equilbrium analysis (LBEA)

A 'retention function' approach is used to account for the possibility of 'discard mortality' (Fairclough et al., 2021; Shertzer et al., 2021). The vulnerability of fish in length class $k$ to the fishing gear, $V_k$, is calculated as

$$
V_k = 1/(1+\exp(-\log_e(19)(L_k-L_{50}^{\mathrm{V}})/(L_{95}^{\mathrm{V}}-L_{50}^{\mathrm{V}})))
$$
where $L_{50}^{\mathrm{V}}$ and $L_{95}^{\mathrm{V}}$ are the lengths at which 50 and 95% of fish are selected by the gear. Note that, for more robust optimisation, $L_{95}^{\mathrm{V}}-L_{50}^{\mathrm{V}}$ is inputted by the user as a single value. Similarly, the probability of fish in length class $k$ being retained, by default, is calculated as

$$
\psi_k = 1/(1+\exp(-\log_e(19)(L_k-L_{50}^{\mathrm{\psi}})/(L_{95}^{\mathrm{\psi}}-L_{50}^{\mathrm{\psi}})))
$$
If a minimum legal length (MLL) does not apply and all fish are assumed to be retained, $\psi_k$ may set by the user to one for all lengths. If an MLL applies and all fishers are assumed to comply with this regulation and high-grading of fish does not occur, $$\psi_k$$ can be set to be 'knife edged', by specifying zero or one, depending on whether the midpoint of its length class is below or above the MLL, respectively. The selectivity of landings, $\phi_k$, for fish in length class $k$, is calculated as

$$
\phi_k = \psi_k V_k
$$
The selectivity of discarding, $D_k$, is calculated as

$$
D_k = 1 - \psi_k V_k
$$

### Fishing mortality - length-based equilbrium analysis (LBEA)

The fishing mortality of fish in length class $k$ allowing for post release mortality, $F_k$, is

$$
F_k = \phi_k + D_k \delta F
$$
where $\delta$ is the specified proportion of fish that die following capture and release. For model scenarios not concerned with post-release mortality, $\delta$, should be set to zero. The fishing mortality of fish in length class $k$ associated with retention, $F_k^R$, is

$$
F_k^R = \phi_k F
$$
and the fishing mortality of fish in length class $k$ associated with discarding, $F_k^D$, is
$$
F_k^D = D_k \delta F
$$
Total mortality for fish in length class $k$ is

$$
Z_k = F_k + M
$$
where $M$ is the instantaneous rate of natural mortality ($y^{-1}$).

### Survival and recruitment - length-based equilbrium analysis (LBEA)

The proportion of fish of sex $s$ and length class $k$ surviving in age $a$ is 

$$
S_{s,k,a} = 
\begin{cases} 
\exp(-Z_k) & \text{if } 1 \le a < A \\
\exp(-Z_k) / (1 - \exp(-Z_k)) & \text{if } a = A 
\end{cases}
$$
where $A$ is the maximum age considered by the model. The sex and age-specific survival matrix is

$$
\textbf{S}_{s,a} = [S_{s,k,a}]= \begin{pmatrix}
S_{s,1,a} & 0 & \cdots & 0 & 0 \\
0 & S_{s,2,a} & \cdots & 0 & 0 \\
\vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & \cdots & S_{s,K-1,a} & 0 \\
0 & 0 & \cdots & 0 & S_{s,K,a}
\end{pmatrix}
$$

The numbers of fish of sex $s$ in the exploited population surviving to age $a$ is 
$$
N_{s,a} = 
\begin{cases} 
R_s & \text{if } a = 1 \\
G_s S_{s,a-1} N_{s,a-1} & \text{if } 1 < a \le A 
\end{cases}
$$
where recruitment, $R_s=0.5$, such that numbers are ‘per recruit’. $R_s$ is a column vector of recruits in the $K$ different length classes, i,e.

$$
R_s = \begin{pmatrix}
\theta_{s,1} \\
\theta_{s,2} \\
\theta_{s,3} \\
\vdots \\
\theta_{s,K}
\end{pmatrix}
$$
The numbers of fish of sex $s$ are represented by a the following number matrix, 

$$
\textbf{N}_s = [N_{s,k,a}] = \begin{pmatrix}
N_{s,1,1} & N_{s,1,2} & \cdots & N_{s,1,A-1} & N_{s,1,A} \\
N_{s,2,1} & N_{s,2,2} & \cdots & N_{s,2,A-1} & N_{s,2,A} \\
\vdots & \vdots & \ddots & \vdots & \vdots \\
N_{s,K-1,1} & N_{s,K-1,2} & \cdots & N_{s,K-1,A-1} & N_{s,K-1,A} \\
N_{s,K,1} & N_{s,K,2} & \cdots & N_{s,K,A-1} & N_{s,K,A}
\end{pmatrix}
$$
the elements of which ($N_{s,k,a}$) are the numbers of fish of sex $s$ in length class $k$ and age $a$, in the population at equilibrium with constant recruitment, mortality and growth. The number of fish of sex $s$ in length class $k$ is thus

$$
N_{s,k} = \sum_{a=1}^A N_{s,k,a}
$$
Note, for functional hermaphrodites $N_{s,k,a}$ is modified such that the numbers of each sex in length class $k$ honor the length-based sex-change relationships. For protogynous hermaphrodites, the proportion of fish that are males in length class $k$ is 

$$
\rho_{s=m,k} = \frac{P_{max,s=m}}{1 + \exp \left( -\ln 19 \frac{L_k - L_{50}^\rho}{L_{95}^\rho - L_{50}^\rho} \right)}
$$
and (for protogynous hermaphrodites) the proportion of fish that are females is 

$$
\rho_{s=f,k} = 1 - \rho_{s=m,k}
$$
At the end of each model age step, the numbers of females modified for expected sex ratio (for protogynous hermaphrodites) is

$$
N'_{s,k,a} = \rho_{s,k} N_{s=f,k,a} + N_{s=m,k,a}
$$
The values of $N_{s,k,a}$ are reset to $N'_{s,k,a}$ at each age step.

### Yield per recruit - length-based equilbrium analysis (LBEA)

Retained catches of fish of sex $s$ in length class $k$ are calculated from the Baranov catch equation, i.e.
$$
C_{s,k}^R = \frac{F_k^R}{Z_k} \left( 1 - \exp(-Z_k) \right) N_{s,k}
$$

Yield per recruit, $YPR$, is calculated as
$$
YPR = \sum_{s=f}^m \sum_{k=1}^K C_{s,k}^R W_{s,k}
$$
where $K$ donotes the number of length classes considered by the model. 


### Spawning potential ratio - length-based equilbrium analysis (LBEA)

Spawning biomass per recruit for sex $s$ when population is at equilibrium with fully-selected fishing mortality, $F$, is

$$
\Phi_{s,F} = \sum_{k=1}^K N_{s,k} W_{s,k} P_{s,k}
$$

The spawning potential ratio, for sex $s$ when the population is at equilibrium with fully-selected fishing mortality, $F$, is
$$
SPR_{s,F} = \frac{\Phi_{s,F}}{\Phi_{s,F=0}}
$$


### Equilibrium recruitment - length or age-based per equilibrium analysis (LBEA or ABEA)

For gonochoristic species, the equilibrium level of Beverton-Holt recruitment for the fished population, relative to that for the unfished population  (Mace and Doonan, 1988) is determined as
$$
R_{eq,F} = \frac{4h \Phi_{s=f,F} - (1 - h) \Phi_{s=f,F=0}}{5h - 0.2 \Phi_{s=f,F}}
$$
For hermaphroditic species, recruitment is calculated from spawning biomass for combined sexes. For hermaphroditic species, depending on user inputs, calculations for equilibrium recruitment can be modified further to account for predicted effects of reduced male spawning biomass on egg fertilisation rates. As fishing tends to be focused towards capturing larger individuals, for protogynous (female to male sex change) in particular, exploitation can potentially result in reduced egg fertilisation rates due to limited sperm availability associated with depletion of males. Following Brooks et al. (2008), fertilisation rate at the current level of fishing pressure, $\zeta$ may be modelled as a function of adult sex ratio,  

$$
\zeta=\frac{4\kappa x}{(1-\kappa)+(5\kappa-1)x}
$$
where $x$ represents the ratio of (i) the proportion of males to mature females in the fish population (measured in terms of numbers) at the current estimated level of fishing mortality to (ii) the proportion of males to mature females in the unfished population. The value of $x$ thus represents a measure of male depletion, which can range from 0 (fully depleted) to 1 (no depletion). Note that the above relationship is similar to a Beverton-Holt stock recruitment relationship and the effect of male depletion on fertilisation rate is affected by a parameter $\kappa$, analogous to the steepness parameter this type of relationship (which can range from 0.2 to 1.0). A high value for $\kappa$ means that the stock is assumed to be able to be able to maintain high fertilisation rates even when males are scarce. It is likely that group spawning species will have a higher value of $\kappa$ than for pair spawning species (Brooks et al., 2008). Specifying a value of 1 for $\zeta$ assumes no effect of male depletion on egg fertilisation rate. In LBEA, equilibrium recruitment is taken as the value for $R_{eq}$, determined from the relevant stock-recruitment relationship, multiplied by $\zeta$. If a value for $\kappa$ is not specified, then $R_{eq}$ is determined from the mature biomass for combined sexes, otherwise it is calculated based on mature female biomass.   

### Equilbrium catch and relative spawning biomass - length or age-based per equilibrium analysis (LBEA or ABEA)

The equilibrium level of catch, for the fished population may be calculated as

$$
R_{eq,F} YPR
$$
The equilibrium level of spawning biomass for sex $s$, for the fished population may be calculated as

$$
B_{eq,s,F} = R_{eq,F} \Phi_{s,F}
$$
The equilibrium ratio of spawning biomass of sex $s$, relative to the unfished level, is

$$
B_{rel,s,F} = \frac{B_{eq,s,F}}{\Phi_{s,F=0}}
$$


### Calculation of biological reference points - age and length-based per equilibrium analyses (LBEA and ABEA)

LBEA and ABEA both output the value of relative biomass $B_{rel}$ corresponding to the level at which $C_{eq}$ is maximised (i.e. at $MSY$). The models also output $F_{MSY}$, the (equilibrium) level of fishing mortality expected to result in the stock being at $B_{MSY}$. The models also output a threshold level for $B{rel}$, corresponding to that at $B_{MSY}$, with the limit set to half this level, and a default target at 1.2 times this level (or higher). Corresponding reference points for fishing mortality (i.e. $F_{targ}$, $F_{thresh}$ and $F_{lim}$), for these biomass reference levels are also outputted. Alternatively, for plotting and risk calculations (see below), pre-specified 'proxy' values may be used, with the limit set to $B_{rel}=0.2$, the threshold at $B_{rel}=0.3$ and target at $B_{rel}=0.4$. Use of pre-specified proxy reference values (rather than calculated $B_{MSY}$ reference points) avoids the issue of the reference levels being strongly affected by the assumed value for the steepness parameter in the stock-recruitment relationship. 

### Allowing for error in per recruit calculations - age and length-based per equilibrium analyses (LBEA and ABEA)

LBEA and ABEA allow for incorporation uncertainty in estimates of fishing mortality, natural mortality and steepness, assuming independent normal or lognormal distributions for each of these parameters. Following the recommendation of Hamel & Cope (2022), for natural mortality, the example code specifies a lognormal distribtuion, with standard deviation value, in log space, of 0.31 (can be modified). For fishing mortality, the standard deviation value can be derived from outputs of catch curve analysis. Estimates of key outputs from per recruit analysis, with uncertainty, are produced using parametric sampling to produce a specified number (e.g. 500) of F, M and h values, which are inputted into the deterministic per recruit equations (i.e. within the CalcYPRAndSPRForFMort() function), to produce 500 sets of estimated results of key parameters of interest. Lower and Upper 95% confidence limits are taken as the 2.5 and 97.5 percentiles of the 500 estimates. 

Note, it is also possible to incorporate other sources of uncertainty, such as for growth and maturity curves, if estimates are available for the  parameters of each curve and variance-covariance matrix for these relationships (such as are outputted by the WAFishBiolgy R package). 'Wrapper' code, involving use of the CalcYPRAndSPRForFMort() function for each set of input parameters, and storing and analysing the outputs to produce confidence limits, can be relatively easily implemented (outside the package).     

### Risk calculations and associated table for relative biomass estimates - age and length-based per equilibrium analyses (LBEA and ABEA)

The function PlotPerRecruit_RiskMatrix_RelBiom()) is available to calculate and plot risk assessment scores associated with estimates relative biomass derived from incorporation of an estimate for fishing mortality in per recruit analysis. The risk methodolgy (ISO 310000) follows the consequence x likelihood approach used for Western Australian fisheries, as described by Fletcher (2015). Outputs are plotted as a risk table, with a risk level (negligible, low, medium, high or severe) assigned to each consequence level (minor; B>Targ; moderate, Thresh<B<Targ; high, Lim<B<Thresh; or major, B<Lim), depending on the likelihood of that risk level (remote, <5%; unlikely, 5-20%; possible, 20-50%, likely, >50%).  

### Calculation of prediction intervals displayed for growth curves - length-based per equilibrium analyses (LBEA)

The function PlotPerRecruitResults_LB() outputs diagnostic plots of growth curves with calculated prediction intervals for lengths-at age, derived using the value for the coefficient of variation (cv) inputted by the user (assumed in the analysis to be constant across lengths) for the specified growth curve. The prediction intervals are calculated using a resampling approach. Specifically, for each of 10,000 females and 10,000 males, a random length class is drawn, assuming a multinomial distribution (i.e. using the rmultinom function() in R), based on the expected proportions of fish in the fished population of sex $s$ in length class $k$ at age $a$, calculated from the expected numbers, $N_{s,k,a}$. For each fish with a randomly-assigned length class, a random value of length from the range of possible lengths of fish within that length class is then drawn, i.e. assuming the lengths of the fish within each length class have a uniform distribution. The upper and lower prediction intervals for length for sex $s$, as shown on the growth curve plots associated with the expected lengths at each age, are taken as the 97.5 and 2.5 percentiles, respectively, of the 10,000 length values for that sex.

### Calculation of expected sizes and weights of fish at different levels of fishing mortality - length-based equilibrium analysis (LBEA)

The function() PlotPerRecruit_ExpCatchSizeDistns_LB provides plots of expected mean sizes and weights of fish in catches, for females, males and combined sexes, over a wide range of fishing mortality levels, with associated 60 and 95 percent prediction intervals. The mean sizes and weights of fish in catches at the value of fishing mortality inputted by the user are also shown. Similar to above (previous heading), at each value of fishing mortality, a resampling approach, using the rmultinom function() in R, is used firstly to generate random length classes for each of 10,000 females and 10,000 males, based on the expected proportions of fish in expected retained catches of sex $s$ and length $k$. These are calculated using $C_{s,k}$, the expected numbers of fish sex $s$ and length $l$ in retained catches. For each fish with a randomly-assigned length class, a random value of length from the range of possible lengths of fish within that length class is then drawn, assuming the lengths of the fish within each length class have a uniform distribution. The upper and lower prediction intervals associated with the expected lengths of fish, are taken as the 97.5 and 2.5 percentiles, respectively, of the 10,000 values of length for each sex. For each fish of sex $s$ with a randomly generated length, its expected weight is calculated using the specified weight-length relationship, given its sex. Upper and lower prediction intervals for weight are calculated using the same approach as for fish length. 

### Value per recruit calculations - length-based equilibrium analysis (LBEA)

Two routines, Get_Relative_Value_Per_Recruit_LB() and PlotValuePerRecruitResults_LB() to extend calculations of the above-described length-based per recruit methods, to undertake 'value'- (or 'utility'-) per-recruit analysis (e.g. see Die et al., 1988; Zhai & Pauly, 2019). Value-per-recruit analysis considers that the value of a fish to a fisher may differ according to fish size, e.g. commercial fishers may receive a greater price per kg for fish of larger size, or recreational fishers may place high value on 'trophy-sized' fish). This analysis in L3Assess considers that the value of a fish (to a fisher) varies in accordance with fish length and that i) there may be a minimum size below which a fish has no value to a fisher (e.g. as it is below the minimum legal length and is therefore discarded if caught) and ii) above that length, value scales according fish length according to the following relationship:

$$
\Lambda_l = \bigg(L_{\min}+((L-L_{min})^{\gamma}\bigg)/L
$$
where, $\Lambda_l$, is a measure of the value of a fish in length class $l$, relative to the value accorded to a fish of length $L_{\min}$, which is the minimum length of a fish to be considered to be of any value to a fisher. $\gamma$ is a parameter specified by the user, for scaling the 'value' of fish according to their length. The value of $L_{\min}$ is calculated according to $W_{min}$, a user specified value representing the minimum weight for a fish to be considered of value (i.e. noting that fishers may be more familiar with comparisons of fish of different weights). Specifically, $L_{\min}$ is calculated as

$$
L_{\min}=(W_{\min}/{a})^{1/b}
$$
where $a$ and $b$ are parameters of a weight-length relationship. For a given level of fishing mortality, the value of all fish (of both sexes) in retained catches is calculated as 

$$
X = \sum_lC_{l}W_{l}\Lambda_lR_{eq}
$$
Values of $X$ are calculated for a wide range of fishing mortalities, and a search is undertaken to identify the value of fishing mortality that maximises $X$. Unless the value of a fish scales in proportion to fish weight (i.e. $\gamma$ is set to one), the optimum value of fishing mortality from a value-per-recruit analysis is expected to be less than from a yield-per-recruit analysis. Note also that the calculations allow for potential fishing impacts on catch, i.e. through impacting recruitment.

### Apply length-based equilibrium analysis (LBEA)

Key functions relevant to applying this method are:  
CalcYPRAndSPRForFMort_LB()  
GetPerRecruitResults_LB()  
PlotPerRecruitResults_LB()  
PlotPerRecruit_Biom_no_err_LB()  
PlotPerRecruit_Yield_no_err_LB()  
PlotPerRecruit_Param_Err_Distns()  
GetPerRecruitResults_with_err_LB()  
PlotPerRecruit_Biom_with_err_LB()  
PlotPerRecruit_RiskMatrix_RelBiom()  
GetPerRecruitGrowthPredIntervals_LB()  
PlotPerRecruit_ExpCatchSizeDistns_LB()  
Get_Relative_Value_Per_Recruit_LB()  
PlotValuePerRecruitResults_LB()  
Refer to help files and example code, showing function inputs and outputs.


## Simulation of age data (assuming constant mortality and recruitment)

The package provides a basic procedure in the SimAgeFreqData() function for simulating age frequency samples, based on the equations provided above describing the age-based catch curve method with logistic selectivity. Given a specified sample size, values for expected catch proportions at age, $\hat{P_a}$, an age sample can be generated from a multinomial distribution, i.e. using the rmultinom() function in R. This method for simulating age frequency data is provided in code for several examples for applying age-based catch curves. Note that these data are generated for a stock assuming logistic age-based selectivity, and that the population is at equilibrium with respect to mortality and recruitment.   

## Simulation of length and age data (assuming constant mortality and recruitment)

The function SimLenAndAgeFreqData() is provided for simulating length and age data, based on the equations and assumptions of the 'length and age based catch curve model (LACC)'. The function produces length frequency samples of a specified sample size, given the expected proportion of fish in each length class $l$, i.e. $\hat{P}_l$, using the rmultinom() function in R. An associated age frequency sample for each length class $l$ is generated from the expected, conditional age distributions for each length class, $\hat{P}_{a|l}$, by applying the rmultinom() function from within R. Note that these data generated for a stock assumed to at equilibrium with respect to mortality and recruitment, assuming logistic length-based selectivity (and allowing for discarding, if specified).  

## Simulation of age data using a dynamic age-structured model (with age-based selectivity)

The function SimLenFreqData_DynMod_AB() simulates age composition data for a specified number of years, allowing for constant or variable mortality, and constant or variable recruitment, from a dynamic length-structured model. This analysis uses outputs from the extended length-based per recruit model (now termed length-based equilibrium analysis, LBEA) to calculate the stock recruitment relationship and specify the initial population at fished equilibrium. This model was used to test the length-based catch curve method (both described in Crisafulli et al., 2025)

## Simulation of length data using a dynamic length-structured model (with length-based selectivity)

The function SimLenFreqData_DynMod_LB() simulates length composition data for a specified number of years, allowing for constant or variable mortality, and or constant or variable recruitment, from a dynamic length-structured model. This analysis uses outputs from the extended age-based per recruit model (now termed age-based equilibrium analysis, ABEA) to calculate the stock recruitment relationship and specify the initial population at fished equilibrium.

## Simulation of length data using a dynamic age-structured model (with length-based selectivity)

The function SimLenAndAgeFreqData_DynMod_ALB() simulates age, length, and condition age-length composition data for a specified number of years, allowing for constant or variable mortality, and or constant or variable recruitment, from a dynamic age-structured model with length-based selectivity. This analysis uses outputs from the extended length-based per recruit model (now termed length-based equilibrium analysis, LBEA) to calculate the stock recruitment relationship and specify the initial population at fished equilibrium.

### Description of dynamic length-structured model for simulating length data

This dynamic length-structured simulation model generates synthetic length data, allowing for variable recruitment (assuming, for this study, constant mortality). The model takes outputs from LBEA and combines these outputs with simulated annual recruitment trends (with specified recruitment variation and associated autocorrelation). Data are simulated for a specified number of years and length composition data are generated for each year. The sample sizes for the simulated length compositions were the same for each year. The length data are generated assuming that the expected proportions of fish at length in retained catches have a multinomial distribution. Note that this analysis shares a number of equations with LBEA (e.g. growth and survival matrices and associated equations) not repeated here. This mathematical description of this model is now also available in the supplementary material for Crisafulli et al (2025).

The initial level of recruitment generated (by LBEA) based on equilibrium conditions with constant recruitment, mortality, and growth of sex $s$ in year $y=0$ and length class $j$ is 

$$
R_{s,y,j} = 
\begin{cases} 
\xi R_y \theta_{s,j} & \text{if } s = f \\
(1 - \xi) R_y \theta_{s,j} & \text{if } s = m 
\end{cases}
$$
where $R_y$ is the initial recruitment for the unfished population, $\theta_{s,j}$ is the proportion of age 1 recruits of sex $s$ in length class $k$ and $\xi$ is the proportion of recruits that are female. The numbers of fish of sex $s$ in year $y$ and length class $j$ relative to the number of recruits at equilibrium in year $y=0$ is 

$$
N_{s,y,a,j} = 
\begin{cases} 
R_{s,y,j} & \text{if } a = 1 \\
\sum_{k=1}^K g_{s,j,k} S_{s,a-1,k} N_{s,y-1,a-1,k} & \text{if } 1 < a \le A 
\end{cases}
$$
where $g_{s,j,k}$ is an element of a sex-specific growth transition matrix, $S_{s,a-1,k}$ is the proportion surviving of fish of sex $s$ at age $a-1$ in length class $k$ (see description of LBEA for more detail). Summing over ages, the number of fish of sex $s$ in year $y$ and length class $j$ is

$$
N_{s,y,j} = \sum_{a=1}^A N_{s,y,a,j}
$$
and, summing of length classes, the number of fish of sex $s$ in year $y$ is

$$
N_{s,y} = \sum_{j=1}^K N_{s,y,j}
$$
Allowing for recruitment variation, the standard deviation for random, normally distributed errors, accounting for autocorrelation, is

$$
\sigma_\epsilon = \sqrt{1 + A_R^2} \sigma_R
$$
where $A_R^2$ is the level of autocorrelation between successive annual recruitment deviation values, and $\sigma_R$ is the standard deviation for recruitment deviations, in log space. The random recruitment deviations are are assumed to be normally distributed, i.e.

$$
\epsilon'_y \sim N(0, \sigma_\epsilon^2)
$$
The random recruitment deviation (accounting for autocorrelation) for year $y$ is

$$
\epsilon_y = A_R \epsilon_{y-1} + \epsilon'_y
$$
The dynamic model assumes a Beverton-Holt stock-recruitment relationship, with parameter $\alpha$

$$
\alpha = (B_{y=0}/R_{y=0}) \frac{1 - h}{4h}
$$
and $\beta$

$$
\beta = (h - 0.2)/(0.8h R_{y=0})
$$

The spawning biomass of fish of sex $s$ in year $y$ is

$$
B_{s,y} = \sum_{k=1}^K N_{s,y,k} P_{s,k} W_{s,k}
$$
Annual recruitment for the simulation projection years, when the stock is not in equilibrium with respect to recruitment is calculated as 

$$
R_{y+1} = \frac{B_{s=f,y}}{\alpha + \beta B_{s=f,y}} \exp \left( \epsilon_y - 0.5 \sigma_R^2 \right)
$$
Note, for hermaphroditic species unfished biomass is calculated for combined sexes. The annual retained catch of fish of sex $s$ in length class $k$, in year $y$, in numbers is determined as follows.

$$
C_{s,y,k} = N_{s,y,k} \frac{F_{s,k}^R}{Z_{s,k}} \left( 1 - \exp(-Z_{s,k}) \right)
$$
Note that, for the study of Crisafulli et al (2025), mortality was assumed to be constant. Alternatively, using the function SimExploitationHistory_DynMod(), a history of variable exploitation may be specified. As with annual recruitment deviations (see above), values of annual fishing mortality may varying around a specified trend (e.g. initial increase, decrease then stabilisation at lower level), using an AR-1 process.


### Generating (simulated) annual length compositions from the dynamic length-structured model

Length frequency samples of a specified sample size for sex $s$ in year $t$, are generated from the expected proportions of such fish in that year in each length class $l$, i.e. $\hat{P}_{t,l}$, using the rmultinom() function in R. The values of $\hat{P_{t,l}}$ are calculated as

$$
\hat{P}_{t,s,k}=C_{t,s,k}/\sum_{k=1}^{K}C_{t,s,k}
$$
### Description of dynamic age-structured model (with age-based selectivity) for simulating age data
In development.

### Description of dynamic age-structured model (with length-based selectivity) for simulating age, length and conditional age-at-length data
In development.


### Apply routines for simulating length and/or age data

Key functions relevant to applying these methods are: 
SimAgeFreqData_EqMod()  
SimLenAndAgeFreqData_EqMod()  
PlotSimLenAndAgeFreqData_EqMod() 
SimLenFreqDat_DirMultDistn_EqMod()  
SimExploitationHistory_DynMod()  
SimLenFreqData_DynMod_LB()  
SimAgeFreqData_DynMod_AB()  
SimLenAndAgeFreqData_DynMod_ALB()  

## References:

Beverton, R. J. H. & Holt, S. J. (1957). On the Dynamics of Exploited Fish Populations. Chapman and Hall, London.

Brooks, E. N., Shertzer, K. W., Gedamke, T. & Vaughan, D. S. (2008). Stock assessment of protogynous fish: evaluating measures of spawning biomass used to estimate biological reference points. Fisheries Bulletin 106, 12-23.

Chapman, D. G., and D. S. Robson. (1960). The analysis of a catch curve. Biometrics 16, 354-368.

Crisafulli, B., Hesp, S. A., Afrifa-Yamoah, E., Mueller, U., Ryan, K., Fairclough, D., Hall, N. & Lo, J. (2025). Accounting for post-release mortality in data-limited, length-based assessments of four demersal fishes with varying life histories. Fisheries Research 281. Art 107238.

Die, D. J., Restrepo, V. R. & Hoenig, J. M. (1988). Utility-per-recruit modeling: a neglected concept. Transactions of the American Fisheries Society 117, 274-281.

Evans-Powell, R. T., Hesp, S. A., Denham, A. & Beckley, L. E. (2024). Implications of big, old, fat, fecund, female fish (BOFFFFs) for the reproductive potential of a demersal teleost stock. Fisheries Research 272. Art. 106934.

Fairclough, D.V., Hesp, S.A., Denham, A., Fisher, E.A., Marks, R., Ryan, K.L., Lek, E., Allen, R. & Crisafulli, B.M. 2021. 2021 assessment of the status of the West Coast Demersal Scalefish Resource. Fisheries Research Report No. 316 Department of Primary Industries and Regional Development, Western Australia. 158 pp.

Fletcher, W. J. (2015). Review and refinement of an existing qualitative risk assessment method for application within an ecosystem-based management framework. ICES Journal of Marine Science (2015), 72(3), 1043–1056. doi:10.1093/icesjms/fsu142.

Hamel, O. S. & Cope, J. M. (2022). Development and considerations for application of a longevity-based prior
for the natural mortality rate. Fisheries Research 256 (2022) 106477.

Hansen, M. J., Madenjian, C. P., Selgeby, J. H., & Helser, T. E. (1997). Gillnet selectivity for lake trout (Salvelinus namaycush) in Lake Superior. Canadian Journal of Fisheries and Aquatic Sciences, 54, 2483–2490.

Hoenig, J. M. (1983). Empirical use of longevity data to estimate mortality rates. Fishery Bulletin 82, 898–903.

Kirkwood, G. P. & Walker, T. I. (1986). Gill net mesh selectivities for gummy shark, Mustelus antarcticus Günther, taken in south-eastern Australia. Australian Journal of Marine and Freshwater Research, 37, 689-697.Kurup, R. G., & Hamilton, D. P. (2002).

Mace, P. M. & Doonan, I. J. (1988). A Generalised Bioeconomic Simulation Model for Fish Population Dynamics. MAFFish, NZ Ministry of Agriculture and Fisheries, Wellington, New Zealand.

Pauly, D. (1990). Length-converted catch curves and the seasonal growth curve of fishes. Fishbyte 8(3), 24-29.

Pauly, D., Moreau, J. & Abad, N. (1995). Comparison of age-stuctured and length-converted catch curves of brown trout Salmo trutta in two French rivers. Fisheries Research 22, 197-204.

Piner, K. R., Lee, H.-H., Maunder, M. N. (2016). Evaluation of using random-at-length observations and an equilibrium approximation of the population age structure in fitting the von Bertalanffy growth function. Fisheries Research 180, 128-137.

Punt, A.E., Garratt, P.A., Govender, A., 1993. On an approach for applying per-recruit methods to a protogynous hermaphrodite, with an illustration for the slinger Chrysoblephus puniceus (Pisces: Sparidae). Afr. J. Mar. Sci.13, 109–119. https://doi.org/10.2989/025776193784287293

Punt, A. E., Kennedy, R. B. & Frusher, S. D. (1997). Estimating the size transition matrix for Tasmanian rock lobster, Jasus edwardsii. Marine and Freshwater Research 48, 981-992.

Ricker,W. E. 1954. Stock and recruitment. Journal of the Fisheries Research Board of Canada 11, 559–623.

Shertzer, K.W., Williams, E.H. & Sagarese, S.R. (2022). Modeling discards in stock assessments: red grouper Epinephelus morio in the U.S. Gulf of Mexico. Fishes 2022, 7(1), 7. Doi.org/10.3390/fishes7010007.

Smith, M. W., Then, A. Y., Wor, C., Ralph, G., Pollock, K. H. & Hoenig, J. M. (2012) Recommendations for Catch-Curve Analysis, North American Journal of Fisheries Management, 32(5), 956-967.

Thorson, J. T., Johnson, K. F., Methot, R. D. & Taylor, I. G. Model-based estimates of effective sample size in stock assessment models using the Dirichlet-multinomial distribution. Fisheries Research 192, 84-93. http://dx.doi.org/10.1016/j.fishres.2016.06.005.

Wakefield, C. B., Williams, A. J., Fisher, E. A., Hall, N. G., Hesp, S. A., Halafihi, T., Kaltavara, J., Vourey, E., Taylor, B. M., O’Malley, J. M., Nicol, S. J., Wise, B. W. & Newman, S. J. (2020). Variations in life history characteristics of the deep-water giant ruby snapper (Etelis sp.) between the Indian and Pacific Oceans and application of a data-poor assessment. Fisheries Research 230.  Art. 105651. 

Zhai, L. & Pauly, D. (2019). Yield-per-Recruit, Utility-per-Recruit, and Relative Biomass of 21 Exploited Fish Species in China's Coastal Seas. Frontiers of Marine Science,  6. Art. 724. https://doi.org/10.3389/fmars.2019.00724.




