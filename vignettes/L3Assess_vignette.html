<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>L3Assess_vignette</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>







<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">L3Assess_vignette</h1>


<div id="TOC">
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a>
<ul>
<li><a href="#age-based-catch-curve-methods" id="toc-age-based-catch-curve-methods">Age-based catch curve methods</a>
<ul>
<li><a href="#chapman-and-robson-1960-mortality-estimator" id="toc-chapman-and-robson-1960-mortality-estimator">Chapman and Robson
(1960) mortality estimator</a></li>
<li><a href="#linear-catch-curve-analysis" id="toc-linear-catch-curve-analysis">Linear catch curve
analysis</a></li>
<li><a href="#catch-curve-analysis-with-logistic-selectivity" id="toc-catch-curve-analysis-with-logistic-selectivity">Catch curve
analysis with logistic selectivity</a></li>
</ul></li>
<li><a href="#length-based-selectivity-analysis" id="toc-length-based-selectivity-analysis">Length-based selectivity
analysis</a>
<ul>
<li><a href="#gillnet-selectivity---kirkwood-and-walker-1986" id="toc-gillnet-selectivity---kirkwood-and-walker-1986">Gillnet
selectivity - Kirkwood and Walker (1986)</a></li>
<li><a href="#apply-gillnet-selectivity---kirkwood-and-walker-1986" id="toc-apply-gillnet-selectivity---kirkwood-and-walker-1986">Apply
gillnet selectivity - Kirkwood and Walker (1986)</a></li>
</ul></li>
<li><a href="#length-based-catch-curve-methods" id="toc-length-based-catch-curve-methods">Length-based catch curve
methods</a>
<ul>
<li><a href="#length-based-catch-curve-lbcc" id="toc-length-based-catch-curve-lbcc">Length-based catch curve
(LBCC)</a></li>
<li><a href="#selectivity-of-fishing-gear-retention-and-discarding---length-based-catch-curve" id="toc-selectivity-of-fishing-gear-retention-and-discarding---length-based-catch-curve">Selectivity
of fishing gear, retention and discarding - length-based catch
curve</a></li>
<li><a href="#fishing-mortality---length-based-catch-curve" id="toc-fishing-mortality---length-based-catch-curve">Fishing mortality
- length-based catch curve</a></li>
<li><a href="#estimating-uncertainty-for-model-outputs" id="toc-estimating-uncertainty-for-model-outputs">Estimating uncertainty
for model outputs</a></li>
<li><a href="#apply-length-based-catch-curve" id="toc-apply-length-based-catch-curve">Apply length-based catch
curve</a></li>
</ul></li>
<li><a href="#length-and-age-based-catch-curve" id="toc-length-and-age-based-catch-curve">Length and age-based catch
curve</a>
<ul>
<li><a href="#apply-length-and-age-based-catch-curve" id="toc-apply-length-and-age-based-catch-curve">Apply length and
age-based catch curve</a></li>
<li><a href="#length-converted-catch-curve-regression-approach" id="toc-length-converted-catch-curve-regression-approach">Length-converted
catch curve (regression approach)</a></li>
<li><a href="#apply-length-converted-catch-curve-regression-approach" id="toc-apply-length-converted-catch-curve-regression-approach">Apply
length-converted catch curve (regression approach)</a></li>
</ul></li>
<li><a href="#age-based-per-recruit-analysis" id="toc-age-based-per-recruit-analysis">Age-based per recruit
analysis</a>
<ul>
<li><a href="#growth-and-maturity---age-based-per-recruit-analysis" id="toc-growth-and-maturity---age-based-per-recruit-analysis">Growth and
maturity - age-based per recruit analysis</a></li>
<li><a href="#gear-selectivity-retention-and-discard-mortality---age-based-per-recruit-analysis" id="toc-gear-selectivity-retention-and-discard-mortality---age-based-per-recruit-analysis">Gear
selectivity, retention and discard mortality - age-based per recruit
analysis</a></li>
<li><a href="#fishing-mortality---age-based-per-recruit-analysis" id="toc-fishing-mortality---age-based-per-recruit-analysis">Fishing
mortality - age-based per recruit analysis</a></li>
<li><a href="#yield-per-recruit---age-based-per-recruit-analysis" id="toc-yield-per-recruit---age-based-per-recruit-analysis">Yield per
recruit - age-based per recruit analysis</a></li>
<li><a href="#spawning-potential-ratio---age-based-per-recruit-analysis" id="toc-spawning-potential-ratio---age-based-per-recruit-analysis">Spawning
potential ratio - age-based per recruit analysis</a></li>
<li><a href="#apply-age-based-per-recruit-analysis" id="toc-apply-age-based-per-recruit-analysis">Apply age-based per
recruit analysis</a></li>
</ul></li>
<li><a href="#length-based-equilbrium-analysis-lbea" id="toc-length-based-equilbrium-analysis-lbea">Length-based equilbrium
analysis (LBEA)</a>
<ul>
<li><a href="#growth---length-based-equilbrium-analysis-lbea" id="toc-growth---length-based-equilbrium-analysis-lbea">Growth -
length-based equilbrium analysis (LBEA)</a></li>
<li><a href="#maturity---length-based-equilbrium-analysis-lbea" id="toc-maturity---length-based-equilbrium-analysis-lbea">Maturity -
length-based equilbrium analysis (LBEA)</a></li>
<li><a href="#selectivity-of-fishing-gear-retention-and-discarding---length-based-equilbrium-analysis-lbea" id="toc-selectivity-of-fishing-gear-retention-and-discarding---length-based-equilbrium-analysis-lbea">Selectivity
of fishing gear, retention and discarding - length-based equilbrium
analysis (LBEA)</a></li>
<li><a href="#fishing-mortality---length-based-equilbrium-analysis-lbea" id="toc-fishing-mortality---length-based-equilbrium-analysis-lbea">Fishing
mortality - length-based equilbrium analysis (LBEA)</a></li>
<li><a href="#survival-and-recruitment---length-based-equilbrium-analysis-lbea" id="toc-survival-and-recruitment---length-based-equilbrium-analysis-lbea">Survival
and recruitment - length-based equilbrium analysis (LBEA)</a></li>
<li><a href="#yield-per-recruit---length-based-equilbrium-analysis-lbea" id="toc-yield-per-recruit---length-based-equilbrium-analysis-lbea">Yield
per recruit - length-based equilbrium analysis (LBEA)</a></li>
<li><a href="#spawning-potential-ratio---length-based-equilbrium-analysis-lbea" id="toc-spawning-potential-ratio---length-based-equilbrium-analysis-lbea">Spawning
potential ratio - length-based equilbrium analysis (LBEA)</a></li>
<li><a href="#equilibrium-recruitment---length-or-age-based-per-equilibrium-analysis-lbea-or-abea" id="toc-equilibrium-recruitment---length-or-age-based-per-equilibrium-analysis-lbea-or-abea">Equilibrium
recruitment - length or age-based per equilibrium analysis (LBEA or
ABEA)</a></li>
<li><a href="#equilbrium-catch-and-relative-spawning-biomass---length-or-age-based-per-equilibrium-analysis-lbea-or-abea" id="toc-equilbrium-catch-and-relative-spawning-biomass---length-or-age-based-per-equilibrium-analysis-lbea-or-abea">Equilbrium
catch and relative spawning biomass - length or age-based per
equilibrium analysis (LBEA or ABEA)</a></li>
<li><a href="#calculation-of-biological-reference-points---age-and-length-based-per-equilibrium-analyses-lbea-and-abea" id="toc-calculation-of-biological-reference-points---age-and-length-based-per-equilibrium-analyses-lbea-and-abea">Calculation
of biological reference points - age and length-based per equilibrium
analyses (LBEA and ABEA)</a></li>
<li><a href="#allowing-for-error-in-per-recruit-calculations---age-and-length-based-per-equilibrium-analyses-lbea-and-abea" id="toc-allowing-for-error-in-per-recruit-calculations---age-and-length-based-per-equilibrium-analyses-lbea-and-abea">Allowing
for error in per recruit calculations - age and length-based per
equilibrium analyses (LBEA and ABEA)</a></li>
<li><a href="#risk-calculations-and-associated-table-for-relative-biomass-estimates---age-and-length-based-per-equilibrium-analyses-lbea-and-abea" id="toc-risk-calculations-and-associated-table-for-relative-biomass-estimates---age-and-length-based-per-equilibrium-analyses-lbea-and-abea">Risk
calculations and associated table for relative biomass estimates - age
and length-based per equilibrium analyses (LBEA and ABEA)</a></li>
<li><a href="#calculation-of-prediction-intervals-displayed-for-growth-curves---length-based-per-equilibrium-analyses-lbea" id="toc-calculation-of-prediction-intervals-displayed-for-growth-curves---length-based-per-equilibrium-analyses-lbea">Calculation
of prediction intervals displayed for growth curves - length-based per
equilibrium analyses (LBEA)</a></li>
<li><a href="#calculation-of-expected-sizes-and-weights-of-fish-at-different-levels-of-fishing-mortality---length-based-equilibrium-analysis-lbea" id="toc-calculation-of-expected-sizes-and-weights-of-fish-at-different-levels-of-fishing-mortality---length-based-equilibrium-analysis-lbea">Calculation
of expected sizes and weights of fish at different levels of fishing
mortality - length-based equilibrium analysis (LBEA)</a></li>
<li><a href="#value-per-recruit-calculations---length-based-equilibrium-analysis-lbea" id="toc-value-per-recruit-calculations---length-based-equilibrium-analysis-lbea">Value
per recruit calculations - length-based equilibrium analysis
(LBEA)</a></li>
<li><a href="#apply-length-based-equilibrium-analysis-lbea" id="toc-apply-length-based-equilibrium-analysis-lbea">Apply length-based
equilibrium analysis (LBEA)</a></li>
</ul></li>
<li><a href="#simulation-of-age-data-assuming-constant-mortality-and-recruitment" id="toc-simulation-of-age-data-assuming-constant-mortality-and-recruitment">Simulation
of age data (assuming constant mortality and recruitment)</a></li>
<li><a href="#simulation-of-length-and-age-data-assuming-constant-mortality-and-recruitment" id="toc-simulation-of-length-and-age-data-assuming-constant-mortality-and-recruitment">Simulation
of length and age data (assuming constant mortality and
recruitment)</a></li>
<li><a href="#simulation-of-length-data-using-a-dynamic-length-structured-model" id="toc-simulation-of-length-data-using-a-dynamic-length-structured-model">Simulation
of length data using a dynamic length-structured model</a>
<ul>
<li><a href="#description-of-dynamic-length-structured-model-for-simulating-length-data" id="toc-description-of-dynamic-length-structured-model-for-simulating-length-data">Description
of dynamic length-structured model for simulating length data</a></li>
<li><a href="#generating-simulated-annual-length-compositions-from-the-dynamic-length-structured-model" id="toc-generating-simulated-annual-length-compositions-from-the-dynamic-length-structured-model">Generating
(simulated) annual length compositions from the dynamic
length-structured model</a></li>
<li><a href="#apply-routines-for-simulating-length-andor-age-data" id="toc-apply-routines-for-simulating-length-andor-age-data">Apply
routines for simulating length and/or age data</a></li>
</ul></li>
<li><a href="#references" id="toc-references">References:</a></li>
</ul></li>
</ul>
</div>

<div id="introduction" class="section level1">
<h1>Introduction</h1>
<div id="last-updated-january-2024-alex-hesp---dpird" class="section level4">
<h4>Last updated January 2024 (Alex Hesp - DPIRD)</h4>
<p>This package is intended as a toolbox of methods with analyses for
conducting “level 3” assessments in Western Australia. These methods are
typically “equilibrium” approaches, used when size and/or age data are
available, together with information on various biological attributes of
species, such as estimates of natural mortality, growth and
maturity.</p>
<p>Typically, a level 3 assessment, as considered by DPIRD in Western
Australia, involves producing a “catch curve” estimate of average ‘long
term’ fishing mortality fitted to age or length composition data. The
long-term ‘fishing mortality’ is either estimated directly, or
indirectly from total mortality and natural mortality. Some catch curve
methods also produce age or length-based estimates of selectivity.</p>
<p>The catch curve estimates of fishing mortality are often compared to
estimates of natural mortality to inform about the (long-term average)
level of fishing pressure the stock has experienced. Note that catch
curve (equilibrium) estimates of fishing mortality typically pertain to
the average value experience over the lifespans of all fish in the
sample, and may not correspond to recent mortality (i.e. as the stock
may not in equilibrium with respect to mortality and other factors,
e.g. recruitment).</p>
<p>The estimates of ‘fishing mortality’ and selectivity may be used, in
combination with other biological information (e.g. growth, maturity
etc,) in per recruit analysis to calculate measures of population
reproductive potential, such as spawning potential ratio (SPR). Per
recruit analysis may be extended from the traditional form to include a
stock-recruitment relationship, to account for potential impacts of
fishing pressure on recruitment (i.e. through impacts on spawning stock
levels). The estimates of spawning potential ratio (or relative female
biomass, from extended per recruit analysis) are used as a proxy for
female spawning biomass.</p>
<p>The estimates of ‘fishing mortality’, from catch curve analysis,
female spawning potential ratio and relative female spawning biomass
from per recruit analysis, may be compared against various standard
points relating to fishing pressure (e.g. <span class="math inline">\(F_\mathrm{targ}=2/3\)</span>, <span class="math inline">\(F_\mathrm{thresh}=M\)</span>, <span class="math inline">\(F_\mathrm{lim}=3/2M\)</span>) and female spawning
stock levels (<span class="math inline">\(B^\mathrm{rel}_\mathrm{targ}=0.4\)</span>, <span class="math inline">\(B^\mathrm{rel}_\mathrm{thresh}=0.3\)</span>, <span class="math inline">\(B^\mathrm{rel}_\mathrm{lim}=0.2\)</span>). The
threshold levels are taken as proxies for long-term levels of fishing
and biomass expected to yield maximum sustainable yield. Note, however,
that if (in particular) the ‘steepness’ of the stock recruitment
relationship is lower than typical for marine broadcast spawning fishes
(~0.75), which would be indicative of lower stock productivity
(e.g. some shark species), then the values of the reference points would
need to be more conservative.</p>
<p>The package contains several age- and length-based routines for catch
curve analysis, per recruit analysis, and an “extended” form of per
recruit analysis with a stock-recruitment relationship. It also contains
an analysis for calculating length-based selectivity given estimates of
selectivity parameters for fish caught by gillnet fishing. The various R
functions output a range of statistics and diagnostic plots.</p>
<p>Please note that this is a ‘trial version’ with testing of the
various routines continuing. Please report any identified issues to Alex
Hesp (<span class="math inline">\(\mathrm{Alex.Hesp@dpird.wa.gov.au}\)</span>).</p>
</div>
<div id="age-based-catch-curve-methods" class="section level2">
<h2>Age-based catch curve methods</h2>
<div id="chapman-and-robson-1960-mortality-estimator" class="section level3">
<h3>Chapman and Robson (1960) mortality estimator</h3>
<p><span class="math display">\[
\hat{Z} =
\ln\bigg[1+\overline{X}-\frac{1}{n}\bigg]^{-1}-\ln\overline{X}-\bigg[\frac{{(n-1)(n-2)}}{n(t+1)(n+t-1)}\bigg]
\]</span> where <span class="math inline">\(\overline{X}\)</span> is the
mean age above the age at full recruitment into the fishery, <span class="math inline">\(n\)</span> is the sample size and <span class="math inline">\(t=n\overline{X}\)</span>.</p>
<p>An approximate estimate of the variance of <span class="math inline">\(Z\)</span> (for large sample sizes) may be
determined as</p>
<p><span class="math display">\[
\hat{\sigma}^2 = \bigg[\frac{(1-\exp(\hat{Z}))^2}{n\exp(\hat{Z}))}\bigg]
\]</span> see Smith et al. (2012). Thus, an approximate 95% confidence
interval for <span class="math inline">\(Z\)</span> may be calculated as
<span class="math inline">\(1.96\sigma\)</span>. Alternatively, 95%
confidence intervals for <span class="math inline">\(Z\)</span> are
calculated using resampling with replacement (bootstrapping). The
resampling procedure involves producing a specified number (500) random
age frequency data sets, and applying the calculating Chapman and Robson
(1960) mortality formula to each of these to produce 500 estimates for
<span class="math inline">\(Z\)</span>. The point estimate for <span class="math inline">\(Z\)</span>, from resamping, is taken as the median
of the 500 calculated values for <span class="math inline">\(Z\)</span>,
and the lower and upper 95 confidence limits as the 2.5 and 97.5
percentiles, respectively. For visualisation, the resampling procedure
is also used to produce estimated frequencies of fish at age (above the
age at full selection) with associated 95% confidence limits, based on
the survival function, i.e.</p>
<p><span class="math display">\[
\hat{N_t} = N_0\exp(-Zt)
\]</span> where, for a given random data set, <span class="math inline">\(\hat{N_t}\)</span> is the estimated number at
relative age <span class="math inline">\(t\)</span>, <span class="math inline">\(N_0\)</span> is the observed number of fish at the
calculated recruitment age (determined from the original data set), at
<span class="math inline">\(t\)</span> is relative age. The observed and
estimated frequencies at age can be visualised in normal or log space
(for comparison with other age-based catch curve methods).</p>
<div id="apply-the-chapman-and-robson-1960-mortality-estimator" class="section level4">
<h4>Apply the Chapman and Robson (1960) mortality estimator</h4>
<p>Key functions relevant to applying this method are:
GetChapmanRobsonMortalityResults()<br />
PlotAgeBasedCatchCurveResults_NormalSpace()<br />
PlotAgeBasedCatchCurveResults_LogSpace()<br />
Refer to help files and example code, showing function inputs and
outputs.</p>
</div>
</div>
<div id="linear-catch-curve-analysis" class="section level3">
<h3>Linear catch curve analysis</h3>
<p>Applying linear catch curve analysis</p>
<p><span class="math display">\[
\begin{align}
    \log_e(N_t) = \log_e(N_0)-Z_t\\
\end{align}
\]</span> where <span class="math inline">\(N_t\)</span> represents the
numbers of fish in the population at time <span class="math inline">\(t\)</span> and <span class="math inline">\(N_0\)</span> is the initial recruitment
(e.g. Haddon, 2011). The value for total mortality, <span class="math inline">\(Z_t\)</span>, is taken as the negative of the
slope of the line. It is assumed that the catch of fish at age <span class="math inline">\(t\)</span> is proportional to the number of fish
in the population at that age, and that the population is at equilibrium
with respect to mortality and recruitment. The model is fitted using the
lm function in R, applying the predict function to estimate 95%
confidence limits for the fitted line. Approximate 95% confidence
intervals for <span class="math inline">\(Z\)</span> are be calculated
as <span class="math inline">\(1.96\sigma\)</span>, where <span class="math inline">\(\sigma\)</span> is the estimate of the standard
error for <span class="math inline">\(Z\)</span> produced by the lm
function. For visualisation, the predict function in R is used to
produce estimated frequencies of fish at age (above the age at full
selection) with associated approximate 95% confidence limits,</p>
<div id="apply-linear-catch-curve-anlaysis" class="section level4">
<h4>Apply linear catch curve anlaysis</h4>
<p>Key functions relevant to applying this method are:<br />
GetLinearCatchCurveResults()<br />
PlotAgeBasedCatchCurveResults_NormalSpace()<br />
PlotAgeBasedCatchCurveResults_LogSpace()<br />
Refer to help files and example code, showing function inputs and
outputs.</p>
</div>
</div>
<div id="catch-curve-analysis-with-logistic-selectivity" class="section level3">
<h3>Catch curve analysis with logistic selectivity</h3>
<p>This age-based catch curve model assumes estimates multiple
parameters, including fully-selected fishing mortality and logistic
selectivity parameters. The model can allow for sex-specific differences
in age-based selectivity if fitted simultaneously to sex-specific age
composition data sets, otherwise selectivity can be assumed to be common
to both sexes. Selectivity at age for sex <span class="math inline">\(s\)</span>, is calculated as</p>
<p><span class="math display">\[
V_{a,s} = 1/(1+\exp(-\log_e(19)(a-A_{50,s})/(A_{95,s}-A_{50,s})))
\]</span></p>
<p>where <span class="math inline">\(A_{50,s}\)</span> and <span class="math inline">\(A_{95,s}\)</span> are the ages at which 50 and 95%
of fish of sex <span class="math inline">\(s\)</span> are selected into
the fishery. Fishing mortality at age for sex <span class="math inline">\(s\)</span>, <span class="math inline">\(F_{a,s}\)</span>, is calculated as <span class="math display">\[
F_{a,s} = V_{a,s}F
\]</span> where <span class="math inline">\(F\)</span> is the
fully-selected fishing mortality. Total mortality at age for sex <span class="math inline">\(s\)</span>, <span class="math inline">\(Z_{a,s}\)</span>, is <span class="math display">\[
Z_{a,s} = F_{a,s}+M
\]</span> The instantaneous rate of natural mortality, <span class="math inline">\(M\)</span>, may be calculated, for example, from
an empirical equation such as that of Hoenig’s (1983) equation for fish,
i.e. <span class="math display">\[
M = \exp(1.46)-(1.01)\log_e(A_{\mathrm{max}})
\]</span> where <span class="math inline">\(A_{max}\)</span> is the
observed maximum age for the species. Setting survival at age zero,
<span class="math inline">\(N_{a=0}\)</span>, to 1, and treating age
<span class="math inline">\(A\)</span> as a ‘plus group’, the expected
number of survivors per recruit for each age is</p>
<p><span class="math display">\[
\begin{align}
    N_{a,s} = N_{a-1,s}\exp(-Z_{a-1,s}) &amp;&amp; \text{if a&lt;A}\\
    N_{a,s} = N_{a-1,s}\exp(-Z_{a-1,s})/(1-\exp(-Z_{a,s})) &amp;&amp;
\text{if a=A}\\
\end{align}
\]</span></p>
<p>where <span class="math inline">\(Z\)</span> is the value of total
mortality for fully selected fish and <span class="math inline">\(A\)</span> is the maximum age considered by the
model. <span class="math inline">\(C_a\)</span>, the catch at age <span class="math inline">\(a\)</span>, may be calculated using the Baranov
catch equation, i.e. <span class="math display">\[
C_{a,s} = N_{a,s}\biggl(\frac{F_{a,s}}{Z_{a,s}}\biggr)(1-\exp(-Z_{a,s}))
\]</span> The expected catch proportion at age for sex <span class="math inline">\(s\)</span>, <span class="math inline">\(\tilde{\pi}_{a,s}\)</span>, is thus <span class="math display">\[
\tilde{\pi}_{a,s} = \frac{C_{a,s}}{\sum_{a=0}^{A}C_{a,s}}
\]</span> The catch curve may be fitted employing the traditional
multinomial log-likelihood or Dirichlet-multinomial log-likelihood.
Following similar notation to Thorson et al. (2017) for these likelihood
functions, the former may be calculated as <span class="math display">\[
\lambda = \sum_{s=1}^{2}\sum_{a=0}^{A}f_{a,s}\log_e(\tilde{\pi}_{a,s})
\]</span> where <span class="math inline">\(f\)</span> is the observed
frequency at age <span class="math inline">\(a\)</span>. The Dirichlet
multinomial likelihood is implemented according to the ‘linear effective
sample size’ parameterisation, as recommended in Thorson et al. (2017),
whereby an effective sample size, <span class="math inline">\(f_{eff}\)</span>, is calculated as</p>
<p><span class="math display">\[
n_{eff}=n\frac{\theta}{1+\theta}
\]</span> Above, <span class="math inline">\(\theta\)</span> is the
variance inflation parameter, estimated when fitting the model, and
<span class="math inline">\(n\)</span> is the total number of
observations. Following Thorson et al. (2017), the Dirichlet-multinomial
log-likelihood, intended to be used to account for over-dispersion in
the data (due to lack of statistical independence of sampled fish) and
provide more realistic estimates of error, is calculated as</p>
<p><span class="math display">\[
\lambda
=\frac{\Gamma(n+1)}{\prod_{a=1}^{A}\Gamma(n|\tilde{\pi}_{a,s}+1)}\frac{\Gamma({\theta}n)}{\Gamma({n+\theta}n)}  \prod_{a=1}^{A}\frac{\Gamma(n|\tilde{\pi}_{a,s}+\theta{n\pi_{a,s}})}{(\theta{n}\pi_{a,s})}
\]</span></p>
<p>The model is fitted by minimising the negative log-likelihood using
nlminb in R, by estimating the fully-selected fishing mortality <span class="math inline">\(F\)</span>, and selectivity parameters, <span class="math inline">\(A_{50,s}\)</span> and <span class="math inline">\(A_{95,s}\)</span>. Estimates of asymptotic
standard errors, <span class="math inline">\(\sigma\)</span>, for each
of the model parameters, are derived from the variance-covariance matrix
(i.e. from the inverted Hessian matrix produced by nlminb). Approximate
95% confidence intervals for the estimated parameters are calculated as
<span class="math inline">\(1.96\sigma\)</span>.</p>
<p>For visualisation, model estimates of the frequency of fish at each
age, with associated 95% confidence intervals, are calculated using a
parametric resampling approach, assuming the estimated model parameters
conform to a multivariate normal distribution. The mvrnorm function
within the MASS package is used together with the values of the
estimated model parameters and associated variance-covariance matrix to
generate 500 random values of each of the model parameters. These, in
turn, are used to produce 500 sets of model estimates for the frequency
of fish at each age, <span class="math inline">\(\tilde{f_a}\)</span>,
calculated as</p>
<p><span class="math display">\[
\tilde{f_a}=\tilde{\pi}_an
\]</span></p>
<p>where <span class="math inline">\(n\)</span> is the observed sample
size. The lower and upper 95 confidence limits for <span class="math inline">\(\hat{f_a}\)</span> are taken as the 2.5 and 97.5
percentiles of the 500 estimates for <span class="math inline">\(\hat{f_a}\)</span>, respectively.</p>
<div id="apply-catch-curve-analysis-with-logistic-selectivity" class="section level4">
<h4>Apply catch curve analysis with logistic selectivity</h4>
<p>Key functions relevant to applying this method are:<br />
GetLogisticCatchCurveResults()<br />
PlotAgeBasedCatchCurveResults_NormalSpace()<br />
PlotAgeBasedCatchCurveResults_LogSpace()<br />
Refer to help files and example code, showing function inputs and
outputs.</p>
</div>
</div>
</div>
<div id="length-based-selectivity-analysis" class="section level2">
<h2>Length-based selectivity analysis</h2>
<div id="gillnet-selectivity---kirkwood-and-walker-1986" class="section level3">
<h3>Gillnet selectivity - Kirkwood and Walker (1986)</h3>
<p>The Kirkwood &amp; Walker (1986) model describes selectivity as a
function of fish length and two parameters for the probability density
function of the gamma distribution, <span class="math inline">\(\theta_1\)</span> and <span class="math inline">\(\theta_2\)</span>. The routine implemented outputs
length-based selectivity schedules (by mesh and overall), from inputted
values for two gillnet selectivity parameters that, in turn, can be
inputted into various routines for catch curve and per recruit analysis.
The routine may be extended in future to estimate the two gillnet
selectivity parameters from gillnet length data.</p>
<p>The relative selectivity of a fish in length class <span class="math inline">\(j\)</span> caught in mesh size <span class="math inline">\(i\)</span> is calculated as <span class="math display">\[
\begin{align}
    S_{ij}
=\bigg(\frac{L_j}{\alpha_i\beta_i}\bigg)^{\alpha_i}\exp\bigg(\alpha-\frac{L_j}{\beta}
\bigg)
\end{align}
\]</span> where <span class="math inline">\(Lj\)</span> is the midpoint
of length class <span class="math inline">\(j\)</span>, and <span class="math inline">\(\alpha_i\)</span> and <span class="math inline">\(\beta_i\)</span> are the parameters of the gamma
distribution determined for mesh size <span class="math inline">\(m_i\)</span>. The values of <span class="math inline">\(\alpha_i\)</span> and <span class="math inline">\(\beta_i\)</span> may be calculated from <span class="math inline">\(m_i\)</span>, <span class="math inline">\(\theta_1\)</span>, a dimensionless scaling
parameter used to relate the mode of the gamma distribution <span class="math inline">\((\alpha,\beta)\)</span> to mesh size and from the
variance <span class="math inline">\((\theta_2)\)</span>, with <span class="math display">\[
\begin{align}
    \alpha_i\beta_i=\theta_1m_i
\end{align}
\]</span> and <span class="math display">\[
\begin{align}
    \beta_i=-0.5(\theta_1m_i-(\theta_2^2m_i^2+4\theta_2)^{0.5})
\end{align}
\]</span> Applying this model, estimates of the relative proportion of
fish in the population from length class <span class="math inline">\(j\)</span> is calculated as</p>
<p><span class="math display">\[
\begin{align}
    \mu_j=\frac{\sum_{i=1}^{I}n_{ij}}{\sum_{i=1}^{I}S_{ij}}
\end{align}
\]</span> where <span class="math inline">\(n_ij\)</span> is the number
of fish in length class <span class="math inline">\(j\)</span> caught in
mesh size <span class="math inline">\(i\)</span>. The relative
selectivity of fish in the multi-mesh research gill net in length class
<span class="math inline">\(j\)</span> is estimated as</p>
<p><span class="math display">\[
\begin{align}
    P_j=\frac{\sum_{i=1}^{I}S_{ij}}{\max\sum_{i=1}^{I}S_{ij}}
\end{align}
\]</span> e.g. Hansen et al. (1997).</p>
<p>The Kirkwood and Walker (1986) gillnet selectivity routines could be
extended to estimate the values of <span class="math inline">\(\theta_1\)</span> and <span class="math inline">\(\theta_2\)</span>, which would involve by
minimising the negative log-likelihood</p>
<p><span class="math display">\[
\begin{align}
    \lambda=\sum_{i=1}^{I}\sum_{j=1}^{J}[n_{ij}\log_e(\mu_jS_{ij})-\mu_jS_{ij}]
\end{align}
\]</span> Note, an important assumption of this implementation of the
Kirkwood &amp; Walker (1986) model is that, at the size of maximum
selectivity, the different meshes to which the model is fitted have
equal fishing power.</p>
</div>
<div id="apply-gillnet-selectivity---kirkwood-and-walker-1986" class="section level3">
<h3>Apply gillnet selectivity - Kirkwood and Walker (1986)</h3>
<p>Key functions relevant to applying this method are:<br />
CalcGillnetSelectivity()<br />
Refer to help files and example code, showing function inputs and
outputs.</p>
</div>
</div>
<div id="length-based-catch-curve-methods" class="section level2">
<h2>Length-based catch curve methods</h2>
<div id="length-based-catch-curve-lbcc" class="section level3">
<h3>Length-based catch curve (LBCC)</h3>
<p>This sex-structured length-based catch curve approach allows for
common or divergent growth between the two sexes and growth variation
(by applying sex-specific length-transition matrices). Selectivity,
fully-selected fishing mortality (and natural mortality) are assumed to
be common to both sexes. Growth can be based on either a von Bertalanffy
growth curve or Schnute growth curve. The approach involves calculating
expected survival and catches for each sex, per recruit, given specified
values for natural mortality, growth parameters (and associated
variation), weight-at-length parameters, and model parameters for
selectivity and fishing mortality.</p>
<div id="growth-calculations---length-based-catch-curve" class="section level4">
<h4>Growth calculations - length-based catch curve</h4>
<p>Assuming a von Bertalanffy growth curve, the expected length of fish
of sex <span class="math inline">\(s\)</span> at age <span class="math inline">\(a\)</span> is</p>
<p><span class="math display">\[
L_{s,a} = L_{s,\infty} \left( 1 - \exp \left( -\kappa_s (a - t_{s,0})
\right) \right)
\]</span> where <span class="math inline">\(L_{s,\infty}\)</span>, <span class="math inline">\(\kappa_s\)</span> and <span class="math inline">\(t_{s,0}\)</span> are the asymptotic length, growth
coefficient and hypothetical age at zero length, for sex <span class="math inline">\(s\)</span>. For alternative equations using the
Schnute growth function, see description below for length-based
equilibrium analysis (LBEA).</p>
<p>The proportion (<span class="math inline">\(\theta_{s,k} \approx
1\)</span>) of sex <span class="math inline">\(s\)</span>, in length
class <span class="math inline">\(k\)</span> at age <span class="math inline">\(a = 1\)</span>, assuming a normal distribution,
with variance <span class="math inline">\(\sigma^2\)</span>, around the
expected length (<span class="math inline">\(\mu_s\)</span>), as
calculated above from the von Bertalanffy growth equation (or from a
Schnute growth equation). That is,</p>
<p><span class="math display">\[
\theta_{s,k} \propto \frac{1}{\sqrt{2\pi\sigma^2}} \int_{L_k^-}^{L_k^+}
\exp \left( -\frac{(l_s - \mu_s)^2}{2\sigma^2} \right) dl_s
\]</span> where <span class="math inline">\(l_s\)</span> refers to a
given length for fish of sex <span class="math inline">\(s\)</span>. The
constant of proportionality is chosen to satisfy the constraint that
<span class="math inline">\(\sum_{k=1}^K \theta_{s,k} = 1\)</span>.
<span class="math inline">\(\Delta L_{s,k}\)</span>. The mean annual
growth increment for fish of sex <span class="math inline">\(s\)</span>
in length class <span class="math inline">\(s\)</span> is calculated
as</p>
<p><span class="math display">\[
\Delta L_{s,k} = L_{\infty,s} - L_k \left( 1 - \exp \left( -\kappa_s
\right) \right)
\]</span> where <span class="math inline">\(L_k\)</span> denotes the
midpoint of length class <span class="math inline">\(k\)</span>.
Elements of the (sex-specific) length transition matrices (Punt et al.,
1997), describing the probability of fish of sex <span class="math inline">\(s\)</span>, in length class <span class="math inline">\(k\)</span> moving into length class <span class="math inline">\(j\)</span> are calculated as</p>
<p><span class="math display">\[
g_{s,j,k} =
\begin{cases}
0 &amp; \text{if } j &lt; k \\
\propto \frac{1}{\sqrt{2\pi\sigma^2}} \int_{L_k^-}^{L_k^+} \exp \left(
-\frac{(l - (L_k + \Delta L_{s,k}))^2}{2\sigma^2} \right) dl &amp;
\text{if } j = k \\
\propto \frac{1}{\sqrt{2\pi\sigma^2}} \int_{L_j^-}^{L_j^+} \exp \left(
-\frac{(l - (L_k + \Delta L_{s,k}))^2}{2\sigma^2} \right) dl &amp;
\text{if } j &gt; k
\end{cases}
\]</span> The sex-specific length transition matrices <span class="math inline">\(\textbf{G}_s\)</span> are of the following form,
noting that the elements (<span class="math inline">\(g_{s,j,k}\)</span>) in each column of the
sex-specific length transition matrix sum to 1</p>
<p><span class="math display">\[
\textbf{G}_s = [g_{s,j,k}]=\begin{pmatrix}
g_{s,1,1} &amp; 0 &amp; \cdots &amp; 0 &amp; 0 \\
g_{s,2,1} &amp; g_{s,2,2} &amp; \cdots &amp; 0 &amp; 0 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\
g_{s,K-1,1} &amp; g_{s,K-2,2} &amp; \cdots &amp; g_{s,K-1,K-1} &amp; 0
\\
g_{s,K,1} &amp; g_{s,K,2} &amp; \cdots &amp; g_{s,K,K-1} &amp; g_{s,K,K}
\end{pmatrix}
\]</span></p>
</div>
</div>
<div id="selectivity-of-fishing-gear-retention-and-discarding---length-based-catch-curve" class="section level3">
<h3>Selectivity of fishing gear, retention and discarding - length-based
catch curve</h3>
<p>A ‘retention function’ approach is used to account for the
possibility of ‘discard mortality’ (Fairclough et al., 2021; Shertzer et
al., 2021). The vulnerability of fish in length class <span class="math inline">\(k\)</span> to the fishing gear, <span class="math inline">\(V_k\)</span>, is calculated as</p>
<p><span class="math display">\[
V_k =
1/(1+\exp(-\log_e(19)(L_k-L_{50}^{\mathrm{V}})/(L_{95}^{\mathrm{V}}-L_{50}^{\mathrm{V}})))
\]</span> where <span class="math inline">\(L_{50}^{\mathrm{V}}\)</span>
and <span class="math inline">\(L_{95}^{\mathrm{V}}\)</span> are the
lengths at which 50 and 95% of fish are selected by the gear. Note that,
for more robust optimisation, <span class="math inline">\(L_{95}^{\mathrm{V}}-L_{50}^{\mathrm{V}}\)</span>
is inputted by the user as a single value. Similarly, the probability of
fish in length class <span class="math inline">\(k\)</span> being
retained, by default, is calculated as</p>
<p><span class="math display">\[
\psi_k =
1/(1+\exp(-\log_e(19)(L_k-L_{50}^{\mathrm{\psi}})/(L_{95}^{\mathrm{\psi}}-L_{50}^{\mathrm{\psi}})))
\]</span> If a minimum legal length (MLL) does not apply and all fish
are assumed to be retained, <span class="math inline">\(\psi_k\)</span>
may set by the user to one for all lengths. If an MLL applies and all
fishers are assumed to comply with this regulation and high-grading of
fish does not occur, <span class="math display">\[\psi_k\]</span> can be
set to be ‘knife edged’, by specifying zero or one, depending on whether
the midpoint of its length class is below or above the MLL,
respectively. The selectivity of landings, <span class="math inline">\(\phi_k\)</span>, for fish in length class <span class="math inline">\(k\)</span>, is calculated as</p>
<p><span class="math display">\[
\phi_k = \psi_k V_k
\]</span> The selectivity of discarding, <span class="math inline">\(D_k\)</span>, is calculated as</p>
<p><span class="math display">\[
D_k = 1 - \psi_k V_k
\]</span></p>
</div>
<div id="fishing-mortality---length-based-catch-curve" class="section level3">
<h3>Fishing mortality - length-based catch curve</h3>
<p>The fishing mortality of fish in length class <span class="math inline">\(k\)</span> allowing for post release mortality,
<span class="math inline">\(F_k\)</span>, is</p>
<p><span class="math display">\[
F_k = \phi_k + D_k \delta F
\]</span> where <span class="math inline">\(\delta\)</span> is the
specified proportion of fish that die following capture and release. For
model scenarios not concerned with post-release mortality, <span class="math inline">\(\delta\)</span>, should be set to zero. The
fishing mortality of fish in length class <span class="math inline">\(k\)</span> associated with retention, <span class="math inline">\(F_k^R\)</span>, is</p>
<p><span class="math display">\[
F_k^R = \phi_k F
\]</span> Total mortality for fish in length class <span class="math inline">\(k\)</span> is</p>
<p><span class="math display">\[
Z_k = F_k + M
\]</span> where <span class="math inline">\(M\)</span> is the
instantaneous rate of natural mortality (<span class="math inline">\(y^{-1}\)</span>).</p>
<div id="survival-and-catch-calculations---length-based-catch-curve" class="section level4">
<h4>Survival and catch calculations - length-based catch curve</h4>
<p>The proportion of fish of sex <span class="math inline">\(s\)</span>
and length class <span class="math inline">\(k\)</span> surviving in age
<span class="math inline">\(a\)</span> is</p>
<p><span class="math display">\[
S_{s,k,a} =
\begin{cases}
\exp(-Z_k) &amp; \text{if } 1 \le a &lt; A \\
\exp(-Z_k) / (1 - \exp(-Z_k)) &amp; \text{if } a = A
\end{cases}
\]</span> where <span class="math inline">\(A\)</span> is the maximum
age considered by the model. The sex and age-specific survival matrix
is</p>
<p><span class="math display">\[
\textbf{S}_{s,a} = [S_{s,k,a}]= \begin{pmatrix}
S_{s,1,a} &amp; 0 &amp; \cdots &amp; 0 &amp; 0 \\
0 &amp; S_{s,2,a} &amp; \cdots &amp; 0 &amp; 0 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; S_{s,K-1,a} &amp; 0 \\
0 &amp; 0 &amp; \cdots &amp; 0 &amp; S_{s,K,a}
\end{pmatrix}
\]</span></p>
<p>The numbers of fish of sex <span class="math inline">\(s\)</span> in
the exploited population surviving to age <span class="math inline">\(a\)</span> is <span class="math display">\[
N_{s,a} =
\begin{cases}
R_s &amp; \text{if } a = 1 \\
G_s S_{s,a-1} N_{s,a-1} &amp; \text{if } 1 &lt; a \le A
\end{cases}
\]</span> where recruitment, <span class="math inline">\(R_s=0.5\)</span>, such that numbers are ‘per
recruit’. <span class="math inline">\(R_s\)</span> is a column vector of
recruits in the <span class="math inline">\(K\)</span> different length
classes, i,e.</p>
<p><span class="math display">\[
R_s = \begin{pmatrix}
\theta_{s,1} \\
\theta_{s,2} \\
\theta_{s,3} \\
\vdots \\
\theta_{s,K}
\end{pmatrix}
\]</span> The numbers of fish of sex <span class="math inline">\(s\)</span> are represented by a the following
number matrix,</p>
<p><span class="math display">\[
\textbf{N}_s = [N_{s,k,a}] = \begin{pmatrix}
N_{s,1,1} &amp; N_{s,1,2} &amp; \cdots &amp; N_{s,1,A-1} &amp; N_{s,1,A}
\\
N_{s,2,1} &amp; N_{s,2,2} &amp; \cdots &amp; N_{s,2,A-1} &amp; N_{s,2,A}
\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\
N_{s,K-1,1} &amp; N_{s,K-1,2} &amp; \cdots &amp; N_{s,K-1,A-1} &amp;
N_{s,K-1,A} \\
N_{s,K,1} &amp; N_{s,K,2} &amp; \cdots &amp; N_{s,K,A-1} &amp; N_{s,K,A}
\end{pmatrix}
\]</span> the elements of which (<span class="math inline">\(N_{s,k,a}\)</span>) are the numbers of fish of sex
<span class="math inline">\(s\)</span> in length class <span class="math inline">\(k\)</span> and age <span class="math inline">\(a\)</span>, in the population at equilibrium with
constant recruitment, mortality and growth. The number of fish of sex
<span class="math inline">\(s\)</span> in length class <span class="math inline">\(k\)</span> is thus</p>
<p><span class="math display">\[
N_{s,k} = \sum_{a=1}^A N_{s,k,a}
\]</span> The estimated numbers of fish of sex <span class="math inline">\(s\)</span> in length class <span class="math inline">\(k\)</span> in retained catches, as calculated from
the Baranov catch equation are</p>
<p><span class="math display">\[
C_{s,k}^R = \frac{F_k^R}{Z_k} \left( 1 - \exp(-Z_k) \right) N_{s,k}
\]</span> The expected proportions of fish in length class <span class="math inline">\(k\)</span> in retained catches for combined sexes
is calculated as</p>
</div>
<div id="objective-function-calculations---length-based-catch-curve" class="section level4">
<h4>Objective function calculations - length-based catch curve</h4>
<p><span class="math display">\[
P_k^R = \frac{\sum_s C_{s,k}^R}{\sum_k \sum_s C_{s,k}^R}
\]</span> The multinomial negative log-likelihood associated with the
observed length composition data for retained fish is as follows</p>
<p><span class="math display">\[
\lambda = \sum_k C_k^R \ln \left( P_k^R + 0.0001 \right)
\]</span> The small constant is used to robustify the calculations.</p>
<p>Note that LBCC may also be fitted simultaneously to size compositions
for retained fish and also for fish of sizes that would typically be
caught and released during normal fishing operations (e.g. if such fish
were measured by researchers during onboard monitoring). In such cases,
an additional multinomial likelihood is calculated, associated with the
observed and expected length distributions for released fish. The model
is then fitted to the summed likelihoods for retained and released fish.
LBCC can also be fitted assuming a Dirichlet-multinomial (rather than
multinomial distribution). The Dirichlet multinomial distribution has
been implemented in the same way as described for the age-based logistic
catch curve in L3Assess (see above), i.e. using the ‘linear effective
sample size’ parameterisation, as recommended in Thorson et
al. (2017)</p>
</div>
<div id="calculation-of-model-diagnostics-on-proportion-of-released-fish-and-mean-length-of-released-fish" class="section level4">
<h4>Calculation of model diagnostics on proportion of released fish, and
mean length of released fish</h4>
<p>The estimated numbers of fish of sex <span class="math inline">\(s\)</span> in length class <span class="math inline">\(k\)</span> that are released (that either survive
or die) may be calcualted as</p>
<p><span class="math display">\[
C_{s,k}^r = \frac{F_k^r}{Z_k} \left( 1 - \exp(-Z_k) \right) N_{s,k}
\]</span> where <span class="math inline">\(F_k^r=D_kF\)</span>.</p>
<p>The predicted proportion of fish that are caught and then released
(which may survive or die), may then be calculated as</p>
<p><span class="math display">\[
z^r =
\Bigg(\frac{\sum_{s}\sum_{k}\hat{C}_{s,k}^{r}}{\sum_{s}\sum_{k}(\hat{C}_{s,k}^R+\hat{C}_{s,k}^{r})}\Bigg)
\]</span></p>
<p>The mean size of fish that are caught and then released (which may
survive or die), may be calculated as</p>
<p><span class="math display">\[
\bar{x}^r =
\Bigg(\frac{\sum_s\sum_k\hat{C}_{s,k}^{r}L_k}{\sum_{s}\sum_k\hat{C}_{s,k}^r}\Bigg)
\]</span></p>
</div>
</div>
<div id="estimating-uncertainty-for-model-outputs" class="section level3">
<h3>Estimating uncertainty for model outputs</h3>
<p>For visualisation, model estimates of the proportion of fish in each
length class, with associated 95% confidence intervals, are also
calculated using a parametric resampling approach, assuming the
estimated model parameters conform to a multivariate normal
distribution. The mvrnorm function within the MASS package is used
together with the values of the estimated model parameters and
associated variance-covariance matrix to generate 200 random values of
each of the model parameters. These, in turn, are used to produce 200
sets of model estimates for the expected proportion of fish in each
length class. The lower and upper 95 confidence limits for <span class="math inline">\(\hat{f_a}\)</span> are taken as the 2.5 and 97.5
percentiles of the 200 estimates for <span class="math inline">\(\hat{P}_l\)</span>, respectively.</p>
<p>The equations outlined above are based on a model assuming an annual
timestep. LBCC can, however, also allow use of alternative model time
step values (e.g. 1/12 of a year vs 1 year). For shorter-lived species
(e.g. &lt; 10 y), it is likely better to use a shorter model timestep
(if samples are collected at intervals throughout the year), such that
the modelled length compositions can more closely match observed data,
by allowing fish to grow throughout the year.</p>
</div>
<div id="apply-length-based-catch-curve" class="section level3">
<h3>Apply length-based catch curve</h3>
<p>Key functions relevant to applying this method are:<br />
SimLenAndAgeFreqData()<br />
GetLengthBasedCatchCurveResults()<br />
PlotLengthBasedCatchCurve_Selectivity()<br />
PlotLengthBasedCatchCurve_Mortality()<br />
PlotLengthBasedCatchCurve_RetCatch()<br />
PlotLengthBasedCatchCurve_DiscCatch()<br />
VisualiseGrowthApplyingLTM()<br />
Refer to help files and example code, showing function inputs and
outputs.</p>
</div>
</div>
<div id="length-and-age-based-catch-curve" class="section level2">
<h2>Length and age-based catch curve</h2>
<p>This model applies the same set of equations as described above for
the length-based catch curve, but is fitted using a modified objective
function with two components, the first associated with the marginal
length composition (as described above), and the second, with
conditional ages-at-length. The approach estimates logistic selectivity
parameters (<span class="math inline">\(L_{50}\)</span> and <span class="math inline">\(L_{95}\)</span>), von Bertalanffy growth
parameters (<span class="math inline">\(L_{\infty,s}\)</span> and <span class="math inline">\(k,s\)</span>) and fully-selected fishing mortality
(<span class="math inline">\(F^*\)</span>). As with the above
length-based model, this model is also sex-structured, allowing growth
to be estimated simultaneously for both sexes, whilst assuming common
length-based selectivity and fully-selected fishing mortality. Single
sex data can also be inputted, allowing for growth, selectivity and
fishing mortality to be estimated separately for each sex. This
mathematical description of this model is now also available in the
supplementary material for Crisafulli et al (in review).</p>
<p>Following Piner et al. (2016), the distribution of ages for a given
length class is assumed to follow a multinomial distribution. The
log-likelihood for <span class="math inline">\({C}_{l,a}\)</span>, the
number of fish in the retained catch in length class <span class="math inline">\(l\)</span> at age <span class="math inline">\(a\)</span>, is calculated as</p>
<p><span class="math display">\[
\lambda_2=\sum_{s}\sum_{k}\sum_{a}{C}_{s,l,a}\log_e(\hat{P_s}{(a|k)})
\]</span></p>
<p>In the above equation, <span class="math inline">\(\hat{P_s}(a|k)\)</span> is the expected
conditional proportion of fish, of sex <span class="math inline">\(s\)</span>, in the catch at age <span class="math inline">\(a\)</span> in length class <span class="math inline">\(k\)</span>, which calculated as</p>
<p><span class="math display">\[
\hat{P_s}{(a|k)}=\frac{\hat{P_s}(k|a)\hat{P_s}(a)}{\sum_{a}\hat{P_s}(k|a)\hat{P_s}(a)}
\]</span> where <span class="math display">\[
\hat{P_s}(a) = \frac{\hat{C}_{s,a}}{\sum_{s,a}\hat{C}_{s,a}}
\]</span> and</p>
<p><span class="math display">\[
\hat{P_s}(k|a) = \frac{\hat{C}_{s,k,a}}{\sum_{k}\hat{C}_{s,k,a}}
\]</span> The overall log-likelihood is calculated as the sum of the
log-likelihoods associated with the marginal length composition, <span class="math inline">\(\lambda_1\)</span> (as described above for the
length-based catch curve method) and the conditional age at length
log-likelihood, <span class="math inline">\(\lambda_2\)</span>.</p>
<p>Note that this catch curve routine also allows use of alternative
model time step values (e.g. 1/12 of a year vs 1 year). For
shorter-lived species (e.g. &lt; 10 y), it is likely more appropriate to
use a shorter model timestep (if samples are collected at intervals
throughout the year), such that the modelled length compositions more
closely match observed data, by allowing fish to grow throughout the
year.</p>
<div id="apply-length-and-age-based-catch-curve" class="section level3">
<h3>Apply length and age-based catch curve</h3>
<p>Key functions relevant to applying this method are:<br />
SimLenAndAgeFreqData()<br />
VisualiseGrowthApplyingLTM()<br />
GetAgeAndLengthBasedCatchCurveResults()<br />
PlotAgeLengthCatchCurve_Growth()<br />
PlotAgeLengthCatchCurve_Selectivity()<br />
PlotAgeLengthCatchCurve_Cond_AL()<br />
PlotAgeLengthCatchCurve_MargLength()<br />
Refer to help files and example code, showing function inputs and
outputs.</p>
</div>
<div id="length-converted-catch-curve-regression-approach" class="section level3">
<h3>Length-converted catch curve (regression approach)</h3>
<p>A length-converted catch curve (e.g. see Pauly 1990, 1995), is
typically a linear regression, and may be described as</p>
<p><span class="math display">\[
\begin{align}
    \log_e[N/{\Delta}_t] = a+bt&#39;_{m}
\end{align}
\]</span> where <span class="math inline">\(N\)</span> is the observed
number of fish in a given length class, <span class="math inline">\({\Delta}_t\)</span> is the time taken for fish to
grow through that length class, <span class="math inline">\(a\)</span>
is the y intercept, <span class="math inline">\(t&#39;_m\)</span> is the
mean (relative) age of fish at the mid-point of that length class. The
negative of <span class="math inline">\(b\)</span> equates to total
mortality, <span class="math inline">\(Z\)</span>. If the growth of the
species is described by a von Bertalanffy growth curve, the relative age
of fish at the lower bound (<span class="math inline">\(t_{lw}\)</span>), upper bound (<span class="math inline">\(t_{up}\)</span>) and mid-point of length class
<span class="math inline">\(t&#39;_l\)</span>, may each be calculated
from the inverse von Bertalanffy growth equation, i.e. <span class="math display">\[
\begin{align}
    t&#39;=-(1/k)(\log_e(1-(L_{t&#39;}-L_\infty))
\end{align}
\]</span></p>
<p>where <span class="math inline">\(t&#39;\)</span> is the relative
age, <span class="math inline">\(L_\infty\)</span> and <span class="math inline">\(k\)</span> are the asymptotic length and growth
coefficient parameters of the growth curve, and <span class="math inline">\(L_t&#39;\)</span> is the length, at <span class="math inline">\(t&#39;\)</span>. In this package, length-converted
catch curves may also be calculated for fish with growth described by a
Schnute growth curve, for cases where the parameters <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are not equal to zero. That is, where
growth is described as</p>
<p><span class="math display">\[
L_t=\bigg((y_1^b+(y_2^b-y_1^b))\frac{1-\exp(-a(t-t_1))}{1-\exp(-a(t_2-t_1))}\bigg)^{1/b}
\]</span> In this case, relative ages may be calculated from the inverse
Schnute growth equation as</p>
<p><span class="math display">\[
t&#39;=\frac{\log_e(1-(L_{t&#39;}^b-y_1^b)/(y_2^b-y_1^b)(1-\exp(-a(t_2-t_1))))}{-a+t_1}
\]</span> In this implementation, using either growth curve model, the
values of <span class="math inline">\({\Delta}_t\)</span> are calculated
as <span class="math display">\[
{\Delta}_t=t_{up}-t_{lw}
\]</span> The length-converted catch curve model is using the lm()
function in R, which outputs estimates of the linear model parameters,
i.e. <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, and associated standard errors.
Approximate 95% confidence limits for the parameters are calculated as
<span class="math inline">\(1.96SE\)</span>. Approximate 95% confidence
limits for the fitted line, estimated at the midpoint of each length
class, are calculated from the outputs of the linear model, using the
predict() function.</p>
</div>
<div id="apply-length-converted-catch-curve-regression-approach" class="section level3">
<h3>Apply length-converted catch curve (regression approach)</h3>
<p>Key functions relevant to applying this method are:<br />
SimLenAndAgeFreqData()<br />
GetPaulyLenConvCatchCurveResults()<br />
PlotLenConvCatchCurveResults()<br />
Refer to help files and example code, showing function inputs and
outputs.</p>
</div>
</div>
<div id="age-based-per-recruit-analysis" class="section level2">
<h2>Age-based per recruit analysis</h2>
<p>This package implements an age-based per recruit analysis, including
several options, some of which represent extensions to traditional per
recruit analysis. Some of these options include, variable model timestep
options (i.e. allowing for a shorter model time step for shorter-lived
species, for more accurate modelling), allowing for post-release
mortality (using a ‘retention-function’ approach), allowing for effects
of fishing on recruitment (i.e. by including a stock-recruitment
relationship), and calculations to determine expected relative biomass
and fishing mortality levels associated with BMSY reference points.</p>
<div id="growth-and-maturity---age-based-per-recruit-analysis" class="section level3">
<h3>Growth and maturity - age-based per recruit analysis</h3>
<p>Growth can be modelled according to a von Bertalanffy growth equation
(with inputted parameter values), or any other form of growth curve with
inputted values for mean length at age. Applying the von Bertalanffy
growth euation, the estimated length of fish at age <span class="math inline">\(t\)</span> and sex <span class="math inline">\(s\)</span>, <span class="math inline">\(L_{t,s}\)</span> is calculated as</p>
<p><span class="math display">\[
L_{t,s} = L_{\infty,s}(1-\exp(-k_s(t-t_{0,s})))
\]</span> where <span class="math inline">\(L_{\infty,s}\)</span>, <span class="math inline">\(k,_s\)</span> and <span class="math inline">\(t_0,s\)</span> are the is the asymptotic length,
growth coefficient hypothetical age at zero length, respectively. The
weight of fish at age <span class="math inline">\(t\)</span>, <span class="math inline">\(W_t\)</span>, in kg, can be inputted as a vector
of mean weights at ages, for calculated from inputted paramerer values
according to a weight-length relationship, either</p>
<p><span class="math display">\[
W_{t,s}=\exp(a_s+b_s\log_eL_{t,s})/1000
\]</span> or <span class="math display">\[
W_{t,s}=(a_s L_{t,s}^ {b_s})/1000
\]</span> where <span class="math inline">\(a_s\)</span> and <span class="math inline">\(b_s\)</span> are the sex-specific weight-length
parameters, for a model fitted to weights measured in g and fish lengths
measured in mm. The probability of a fish of sex <span class="math inline">\(s\)</span> being mature at age <span class="math inline">\(t\)</span> is calculated as</p>
<p><span class="math display">\[
P_{s,a} =
1/(1+\exp(-\log_e(19)(a-a_{50,s}^{\mathrm{M}})/(a_{95,s}^{\mathrm{M}}-a_{50,s}^{\mathrm{M}})))
\]</span> where <span class="math inline">\(a_{50,s}^{\mathrm{M}}\)</span> and <span class="math inline">\(a_{95,s}^{\mathrm{M}}\)</span> are the ages at
which 50 and 95% of fish are mature, respectively.</p>
</div>
<div id="gear-selectivity-retention-and-discard-mortality---age-based-per-recruit-analysis" class="section level3">
<h3>Gear selectivity, retention and discard mortality - age-based per
recruit analysis</h3>
<p>The model employs a ‘retention function’ approach to account for such
‘discard mortality’ (Fairclough et al., 2021; Shertzer et al., 2021).
Applying this approach, the vulnerability of fish of sex <span class="math inline">\(s\)</span> and age <span class="math inline">\(a\)</span> to the fishing gear. <span class="math inline">\(V_{s,a}\)</span> is calculated as</p>
<p><span class="math display">\[
V_{s,a} =
1/(1+\exp(-\log_e(19)(a-a_{50,s}^{\mathrm{V}})/(a_{95,s}^{\mathrm{V}}-a_{50,s}^{\mathrm{V}})))
\]</span></p>
<p>where <span class="math inline">\(a_{50,s}^{\mathrm{V}}\)</span> and
<span class="math inline">\(a_{95,s}^{\mathrm{V}}\)</span> are the ages
at which 50 and 95% of fish of sex <span class="math inline">\(s\)</span> are selected by the gear. <span class="math inline">\(\psi_{s,a}\)</span>, the probability of a fish
(during normal fishing operations) of either sex at age <span class="math inline">\(t\)</span> being retained (i.e. retention ogive)
at age <span class="math inline">\(a\)</span>, is calculated as</p>
<p><span class="math display">\[
\psi_{s,a} =
1/(1+\exp(-\log_e(19)(a-a_{50,s}^{\mathrm{\psi}})/(a_{95,s}^{\mathrm{\psi}}-a_{50,s}^{\mathrm{\psi}})))
\]</span> where <span class="math inline">\(a_{50,s}^{\mathrm{\psi}}\)</span> and <span class="math inline">\(a_{95,s}^{\mathrm{\psi}}\)</span> are the ages at
which 50 and 95% of fish of sex <span class="math inline">\(s\)</span>
are retained.</p>
<p>The selectivity of fish landings, <span class="math inline">\(\phi_{s,a}\)</span> for sex <span class="math inline">\(s\)</span> and age <span class="math inline">\(a\)</span> is calculated as</p>
<p><span class="math display">\[
\phi_{s,a}=\psi_{s,a}V_{s,a}
\]</span> The selectivity of discarding is calculated as</p>
<p><span class="math display">\[
\delta{s,a}=V_{s,a}(1-\psi_{s,a})
\]</span></p>
</div>
<div id="fishing-mortality---age-based-per-recruit-analysis" class="section level3">
<h3>Fishing mortality - age-based per recruit analysis</h3>
<p>For model scenarios not allowing for post-release mortality of
undersize fish, the proportion of fish that die following capture and
release, <span class="math inline">\(D\)</span>, is set to zero. In such
cases, the annual fishing mortality associated with capture and
retention of fish of sex <span class="math inline">\(s\)</span> at age
<span class="math inline">\(t\)</span> is calculated as</p>
<p><span class="math display">\[
F_{s,t}=\psi_{s,a}F
\]</span> where <span class="math inline">\(F\)</span> is the
fully-selected fishing mortality. Conversely, for model scenarios
allowing for post-release mortality (i.e. <span class="math inline">\(D&gt;0.01\)</span>), <span class="math inline">\(F_{s,a}\)</span> is calculated as</p>
<p><span class="math display">\[
F_{s,a} = (\phi_{s,a}+\delta_{s,a}D)F
\]</span> where <span class="math inline">\(\phi_{s,a}\)</span> and
<span class="math inline">\(\delta{s,a}\)</span> are the selectivity of
fish landings and fish discards, respectively, for fish of sex <span class="math inline">\(s\)</span> and age <span class="math inline">\(a\)</span>. The fishing mortality of fish of sex
<span class="math inline">\(s\)</span> at the midpoint at age <span class="math inline">\(a\)</span> associated with retention, <span class="math inline">\(F_{s,a}^R\)</span> is calculated as</p>
<p><span class="math display">\[
F_{s,a}^R=\phi_{s,a}F
\]</span></p>
<p>Total mortality for fish of sex <span class="math inline">\(s\)</span> at age <span class="math inline">\(t\)</span> is calculated as</p>
<p><span class="math display">\[
Z_{s,a} = F_{s,a}+M
\]</span> where <span class="math inline">\(M\)</span> is the
instantaneous rate of natural mortality (<span class="math inline">\(y^-1\)</span>).</p>
</div>
<div id="yield-per-recruit---age-based-per-recruit-analysis" class="section level3">
<h3>Yield per recruit - age-based per recruit analysis</h3>
<p>Yield per recruit, <span class="math inline">\(YPR\)</span>, is
calculated as <span class="math display">\[
YPR = \sum_{s=1}^{2}\sum_{a=0}^{A}C_{s,a}W_{s,a}
\]</span> where the catch of fish of sex <span class="math inline">\(s\)</span> at age <span class="math inline">\(a\)</span>, i.e. <span class="math inline">\(C_{s,a}\)</span>, is calculated from the Baranov
catch equation. <span class="math display">\[
C_{s,a} =
N_{s,a}\biggl(\frac{F_{s,a}^R}{Z_{s,a}}\biggr)(1-\exp(-Z_{s,a}))
\]</span> In the above equation, <span class="math inline">\(N_s,a\)</span>, i.e. the numbers of sex <span class="math inline">\(s\)</span> at age <span class="math inline">\(a\)</span>, for the fished population are
calculated as <span class="math display">\[
\begin{align}
    N_{s,a} = \xi &amp;&amp; \text{if s=1 and a=0}\\
    N_{s,a} = 1-\xi &amp;&amp; \text{if s=2 and a=0}\\
    N_{s,a} = N_{s,a-1}\exp(-Z_{s,a-1}) &amp;&amp; \text{if
0&lt;a&lt;A}\\
    N_{s,a} = N_{s,a-1}\exp(-Z_{s,a-1})/(1-\exp(-Z_{s,a-1})) &amp;&amp;
\text{if a=A}\\
\end{align}
\]</span> where <span class="math inline">\(\xi\)</span> is the ratio of
females to males at age 0 yr, and <span class="math inline">\(A\)</span>, is the maximum age considered by the
model. The numbers of sex <span class="math inline">\(s\)</span> at age
<span class="math inline">\(a\)</span> for the unfished population,
<span class="math inline">\(\acute{N}_{s,a}\)</span> are calculated as
above for <span class="math inline">\(N_{s,a}\)</span>, but replacing
all values for total mortality with natural mortality, <span class="math inline">\(M\)</span>.</p>
<p>If the species is a protogynous hermaphrodite (female to male sex
change), the proportion of females at age is assumed to remain constant,
described by the following inverse logistic relationship</p>
<p><span class="math display">\[
\rho_{a} =
1-\bigg[P_{max}^{s=2}/(1+\exp(-\log_e(19)(a-a_{50}^{\rho})/(a_{95}^{\rho}-a_{50}^{\rho})))\bigg]
\]</span> where <span class="math inline">\(P_{max}^{s=2}\)</span> is
the maximum proportion for the terminal sex (males) and <span class="math inline">\(a_{50}^{\rho}\)</span> and <span class="math inline">\(a_{95}^{\rho}\)</span> are the ages at which 50
and 95% of <span class="math inline">\(P_{max}^\rho\)</span> are males.
For protandrous species (male to female sex change), <span class="math inline">\(\rho_{a}\)</span> is calculated as <span class="math display">\[
\rho_{a} =
P_{max}^{s=1}/(1+\exp(-\log_e(19)(a-a_{50}^{\rho})/(a_{95}^{\rho}-a_{50}^{\rho})))
\]</span> where <span class="math inline">\(P_{max}^{s=1}\)</span>, the
terminal sex, is females. For hermaphroditic species, the values of
<span class="math inline">\(N_{s,a}\)</span> become modified, prior
calculation of survival at the next age step, to reflect the assumed sex
ratios at age. The modified values for female, <span class="math inline">\(N&#39;_{s=1,a}\)</span> are calculated as</p>
<p><span class="math display">\[
N&#39;_{s=1,a}=\rho_{a}(N_{s=1,a}+N_{s=2,a})
\]</span> and those for males as <span class="math display">\[
N&#39;_{s=1,a}=(1-\rho_{a})(N_{s=1,a}+N_{s=2,a})
\]</span></p>
</div>
<div id="spawning-potential-ratio---age-based-per-recruit-analysis" class="section level3">
<h3>Spawning potential ratio - age-based per recruit analysis</h3>
<p>Spawning biomass per recruit for sex <span class="math inline">\(s\)</span> when population is at equilibrium with
fully-selected fishing mortality, <span class="math inline">\(F\)</span>, is</p>
<p><span class="math display">\[
\Phi_{s,F} = \sum_{a=0}^A N_{s,a} W_{s,a} P_{s,a}
\]</span></p>
<p>The spawning potential ratio, for sex <span class="math inline">\(s\)</span> when the population is at equilibrium
with fully-selected fishing mortality, <span class="math inline">\(F\)</span>, is <span class="math display">\[
SPR_{s,F} = \frac{\Phi_{s,F}}{\Phi_{s,F=0}}
\]</span></p>
</div>
<div id="apply-age-based-per-recruit-analysis" class="section level3">
<h3>Apply age-based per recruit analysis</h3>
<p>Key functions relevant to applying this method are:<br />
CalcYPRAndSPRForFMort_AB()<br />
GetPerRecruitResults_AB()<br />
PlotPerRecruitResults_AB()<br />
PlotPerRecruit_Biom_no_err_AB()<br />
PlotPerRecruit_Yield_no_err_AB()<br />
PlotPerRecruit_Param_Err_Distns()<br />
GetPerRecruitResults_with_err_AB()<br />
PlotPerRecruit_Biom_with_err_AB()<br />
PlotPerRecruit_RiskMatrix_RelBiom()<br />
Refer to help files and example code, showing function inputs and
outputs.</p>
</div>
</div>
<div id="length-based-equilbrium-analysis-lbea" class="section level2">
<h2>Length-based equilbrium analysis (LBEA)</h2>
<p>This package implements an extended form of length-based per recruit
analysis, now referred to as length-based equilibrium analysis (LBEA);
see Crisafulli et al. (in review), with a range of extensions, one of
which is to allow for effects of fishing on recruitment through
inclusion of a stock-recruitment relationship (e.g. see Punt et al.,
1993). Various options included are i) allowing for post-release
mortality (using a ‘retention-function’ approach), ii) allowing for
isometric or hyperallometric scaling of reproductive output (i.e. BOFFFF
effects), and iii) allowing for alternative forms of growth curve
(Schnute or von Bertalanffy growth model) and iv) calculations to
determine expected relative biomass and fishing mortality levels
associated with BMSY reference points. Routines are also included to
assess effects of fishing mortality on expected sizes of fish catch
(fish length and body weight) distributions, and also predict how
‘value-per-recruit’ changes with exploitation. The equations provided
below describe models assuming an annual timestep, although LBEA can
also assume a shorter timestep (likely best for shorter-lived species. A
number of the model equations are the same as for LBCC but, for
completeness, are repeated here. This mathematical description of this
model is now also available in the supplementary material for Crisafulli
et al (in review).</p>
<div id="growth---length-based-equilbrium-analysis-lbea" class="section level3">
<h3>Growth - length-based equilbrium analysis (LBEA)</h3>
<p>If assuming a von Bertalanffy growth curve, the expected length of
fish of sex <span class="math inline">\(s\)</span> at age <span class="math inline">\(a\)</span> is</p>
<p><span class="math display">\[
L_{s,a} = L_{s,\infty} \left( 1 - \exp \left( -\kappa_s (a - t_{s,0})
\right) \right)
\]</span> where <span class="math inline">\(L_{s,\infty}\)</span>, <span class="math inline">\(\kappa_s\)</span> and <span class="math inline">\(t_{s,0}\)</span> are the asymptotic length, growth
coefficient and hypothetical age at zero length, for sex <span class="math inline">\(s\)</span>. Alternatively, applying a Schnute
growth model (with parameters <span class="math inline">\(c\)</span> and
<span class="math inline">\(d\)</span> not equal to zero), <span class="math inline">\(L_{t,s}\)</span> is calculated as</p>
<p><span class="math display">\[
L_{s,a}=\bigg((y_{1,s}^d+(y_{2,s}^d-y_{1,s}^d))\frac{1-\exp(-c_s(a-t_1))}{1-\exp(-c_s(t_2-t_1))}\bigg)^{1/d_s}
\]</span> where <span class="math inline">\(t_1\)</span> and <span class="math inline">\(t_2\)</span> are specified ‘references’ ages for
estimated lengths <span class="math inline">\(y_{1,s}\)</span> and <span class="math inline">\(y_{2,s}\)</span>, at those ages, respectively.</p>
<p>The proportion (<span class="math inline">\(\theta_{s,k} \approx
1\)</span>) of sex <span class="math inline">\(s\)</span>, in length
class <span class="math inline">\(k\)</span> at age <span class="math inline">\(a = 1\)</span>, assuming a normal distribution,
with variance <span class="math inline">\(\sigma^2\)</span>, around the
expected length (<span class="math inline">\(\mu_s\)</span>), as
calculated above from the relevant growth equation. That is,</p>
<p><span class="math display">\[
\theta_{s,k} \propto \frac{1}{\sqrt{2\pi\sigma^2}} \int_{L_k^-}^{L_k^+}
\exp \left( -\frac{(l_s - \mu_s)^2}{2\sigma^2} \right) dl_s
\]</span> where <span class="math inline">\(l_s\)</span> refers to a
given length for fish of sex <span class="math inline">\(s\)</span>. The
constant of proportionality is chosen to satisfy the constraint that
<span class="math inline">\(\sum_{k=1}^K \theta_{s,k} = 1\)</span>.
<span class="math inline">\(\Delta L_{s,k}\)</span>. The mean annual
growth increment for fish of sex <span class="math inline">\(s\)</span>
in length class <span class="math inline">\(s\)</span> is calculated
as</p>
<p><span class="math display">\[
\Delta L_{s,k} = L_{\infty,s} - L_k \left( 1 - \exp \left( -\kappa_s
\right) \right)
\]</span> where <span class="math inline">\(L_k\)</span> denotes the
midpoint of length class <span class="math inline">\(k\)</span>. Using
the Schnute growth function, <span class="math inline">\(\Delta
L_{s,k}\)</span> is calculated i) by determining the mean expected age
of fish in length class <span class="math inline">\(k\)</span> (from the
inverse Schnute growth equation, if <span class="math inline">\(c\)</span> and <span class="math inline">\(d\)</span> are not equal to zero), ii) calculating
the mean expected length for such fish at their expected age for the
next model timestep (from the Schnute growth equation), and then iii)
calculating the difference between the lengths of fish at the two
respective ages. From the inverse Schnute growth function, the mean age
at length <span class="math inline">\(L_{t,s}\)</span> is<br />
<span class="math display">\[
a_k =
\ln(1-({L_{s,k}}^d-{y_{1,s}}^d)/({y_{2,s}}^b-{y_{1,s}}^d))(1-\exp(-c(t_2-t_1))))/(-c+t_1)
\]</span> To robustify analysis employing Schnute growth equations,
values of <span class="math inline">\(L_k\)</span> are constrained to
not exceed the asymptotic length <span class="math inline">\(L_{\infty,s}\)</span>, expected from the Schnute
growth equation, i.e.</p>
<p><span class="math display">\[
L_{\infty,s}=((\exp(a.t_2){y_{2,s}}^d-\exp(a.t_1){y_{1,s}}^b)/(\exp(a.t_2)-\exp(a.t_1)))^{1/d}
\]</span> The elements of the (sex-specific) length transition matrices
(Punt et al., 1997), describing the probability of fish of sex <span class="math inline">\(s\)</span>, in length class <span class="math inline">\(k\)</span> moving into length class <span class="math inline">\(j\)</span> are calculated as</p>
<p><span class="math display">\[
g_{s,j,k} =
\begin{cases}
0 &amp; \text{if } j &lt; k \\
\propto \frac{1}{\sqrt{2\pi\sigma^2}} \int_{L_k^-}^{L_k^+} \exp \left(
-\frac{(l - (L_k + \Delta L_{s,k}))^2}{2\sigma^2} \right) dl &amp;
\text{if } j = k \\
\propto \frac{1}{\sqrt{2\pi\sigma^2}} \int_{L_j^-}^{L_j^+} \exp \left(
-\frac{(l - (L_k + \Delta L_{s,k}))^2}{2\sigma^2} \right) dl &amp;
\text{if } j &gt; k
\end{cases}
\]</span> The sex-specific length transition matrices <span class="math inline">\(\textbf{G}_s\)</span> are of the following form,
noting that the elements (<span class="math inline">\(g_{s,j,k}\)</span>) in each column of the
sex-specific length transition matrix sum to 1</p>
<p><span class="math display">\[
\textbf{G}_s = [g_{s,j,k}]=\begin{pmatrix}
g_{s,1,1} &amp; 0 &amp; \cdots &amp; 0 &amp; 0 \\
g_{s,2,1} &amp; g_{s,2,2} &amp; \cdots &amp; 0 &amp; 0 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\
g_{s,K-1,1} &amp; g_{s,K-2,2} &amp; \cdots &amp; g_{s,K-1,K-1} &amp; 0
\\
g_{s,K,1} &amp; g_{s,K,2} &amp; \cdots &amp; g_{s,K,K-1} &amp; g_{s,K,K}
\end{pmatrix}
\]</span></p>
<p><span class="math inline">\(W_l\)</span>, the weight of fish of sex
<span class="math inline">\(s\)</span> in length class <span class="math inline">\(k\)</span>, can be inputted as a vector of mean
weights at the midpoints of each length class considered in the model,
or calculated from inputted parameter values, according to a
weight-length relationship, either</p>
<p><span class="math display">\[
W_{s,k} = \exp(WL_{s,a} + WL_{s,b} \ln L_k) / 1000
\]</span> or <span class="math display">\[
W_{s,k}=(WL_{s,a}.L_k^ {WL_{s,b}})/1000
\]</span> where <span class="math inline">\(WL_{s,a}\)</span> and <span class="math inline">\(WL_{s,b}\)</span> are the sex-specific
weight-length parameters, for a model fitted to weights measured in g
and fish lengths measured in mm.</p>
</div>
<div id="maturity---length-based-equilbrium-analysis-lbea" class="section level3">
<h3>Maturity - length-based equilbrium analysis (LBEA)</h3>
<p>The probability of a fish of sex <span class="math inline">\(s\)</span> being mature in length class <span class="math inline">\(k\)</span> is</p>
<p><span class="math display">\[
P_{s,k} = 1/(1 + \exp( -\ln(19) (L_{s,k} - L_{50,s}^M)/(L_{95,s}^M -
L_{50,s}^M)))
\]</span></p>
<p>where <span class="math inline">\(L_{50,s}^M\)</span> and <span class="math inline">\(L_{95,s}^M\)</span> are the lengths at which 50
and 95% of fish are mature, respectively.</p>
</div>
<div id="selectivity-of-fishing-gear-retention-and-discarding---length-based-equilbrium-analysis-lbea" class="section level3">
<h3>Selectivity of fishing gear, retention and discarding - length-based
equilbrium analysis (LBEA)</h3>
<p>A ‘retention function’ approach is used to account for the
possibility of ‘discard mortality’ (Fairclough et al., 2021; Shertzer et
al., 2021). The vulnerability of fish in length class <span class="math inline">\(k\)</span> to the fishing gear, <span class="math inline">\(V_k\)</span>, is calculated as</p>
<p><span class="math display">\[
V_k =
1/(1+\exp(-\log_e(19)(L_k-L_{50}^{\mathrm{V}})/(L_{95}^{\mathrm{V}}-L_{50}^{\mathrm{V}})))
\]</span> where <span class="math inline">\(L_{50}^{\mathrm{V}}\)</span>
and <span class="math inline">\(L_{95}^{\mathrm{V}}\)</span> are the
lengths at which 50 and 95% of fish are selected by the gear. Note that,
for more robust optimisation, <span class="math inline">\(L_{95}^{\mathrm{V}}-L_{50}^{\mathrm{V}}\)</span>
is inputted by the user as a single value. Similarly, the probability of
fish in length class <span class="math inline">\(k\)</span> being
retained, by default, is calculated as</p>
<p><span class="math display">\[
\psi_k =
1/(1+\exp(-\log_e(19)(L_k-L_{50}^{\mathrm{\psi}})/(L_{95}^{\mathrm{\psi}}-L_{50}^{\mathrm{\psi}})))
\]</span> If a minimum legal length (MLL) does not apply and all fish
are assumed to be retained, <span class="math inline">\(\psi_k\)</span>
may set by the user to one for all lengths. If an MLL applies and all
fishers are assumed to comply with this regulation and high-grading of
fish does not occur, <span class="math display">\[\psi_k\]</span> can be
set to be ‘knife edged’, by specifying zero or one, depending on whether
the midpoint of its length class is below or above the MLL,
respectively. The selectivity of landings, <span class="math inline">\(\phi_k\)</span>, for fish in length class <span class="math inline">\(k\)</span>, is calculated as</p>
<p><span class="math display">\[
\phi_k = \psi_k V_k
\]</span> The selectivity of discarding, <span class="math inline">\(D_k\)</span>, is calculated as</p>
<p><span class="math display">\[
D_k = 1 - \psi_k V_k
\]</span></p>
</div>
<div id="fishing-mortality---length-based-equilbrium-analysis-lbea" class="section level3">
<h3>Fishing mortality - length-based equilbrium analysis (LBEA)</h3>
<p>The fishing mortality of fish in length class <span class="math inline">\(k\)</span> allowing for post release mortality,
<span class="math inline">\(F_k\)</span>, is</p>
<p><span class="math display">\[
F_k = \phi_k + D_k \delta F
\]</span> where <span class="math inline">\(\delta\)</span> is the
specified proportion of fish that die following capture and release. For
model scenarios not concerned with post-release mortality, <span class="math inline">\(\delta\)</span>, should be set to zero. The
fishing mortality of fish in length class <span class="math inline">\(k\)</span> associated with retention, <span class="math inline">\(F_k^R\)</span>, is</p>
<p><span class="math display">\[
F_k^R = \phi_k F
\]</span> and the fishing mortality of fish in length class <span class="math inline">\(k\)</span> associated with discarding, <span class="math inline">\(F_k^D\)</span>, is <span class="math display">\[
F_k^D = D_k \delta F
\]</span> Total mortality for fish in length class <span class="math inline">\(k\)</span> is</p>
<p><span class="math display">\[
Z_k = F_k + M
\]</span> where <span class="math inline">\(M\)</span> is the
instantaneous rate of natural mortality (<span class="math inline">\(y^{-1}\)</span>).</p>
</div>
<div id="survival-and-recruitment---length-based-equilbrium-analysis-lbea" class="section level3">
<h3>Survival and recruitment - length-based equilbrium analysis
(LBEA)</h3>
<p>The proportion of fish of sex <span class="math inline">\(s\)</span>
and length class <span class="math inline">\(k\)</span> surviving in age
<span class="math inline">\(a\)</span> is</p>
<p><span class="math display">\[
S_{s,k,a} =
\begin{cases}
\exp(-Z_k) &amp; \text{if } 1 \le a &lt; A \\
\exp(-Z_k) / (1 - \exp(-Z_k)) &amp; \text{if } a = A
\end{cases}
\]</span> where <span class="math inline">\(A\)</span> is the maximum
age considered by the model. The sex and age-specific survival matrix
is</p>
<p><span class="math display">\[
\textbf{S}_{s,a} = [S_{s,k,a}]= \begin{pmatrix}
S_{s,1,a} &amp; 0 &amp; \cdots &amp; 0 &amp; 0 \\
0 &amp; S_{s,2,a} &amp; \cdots &amp; 0 &amp; 0 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; S_{s,K-1,a} &amp; 0 \\
0 &amp; 0 &amp; \cdots &amp; 0 &amp; S_{s,K,a}
\end{pmatrix}
\]</span></p>
<p>The numbers of fish of sex <span class="math inline">\(s\)</span> in
the exploited population surviving to age <span class="math inline">\(a\)</span> is <span class="math display">\[
N_{s,a} =
\begin{cases}
R_s &amp; \text{if } a = 1 \\
G_s S_{s,a-1} N_{s,a-1} &amp; \text{if } 1 &lt; a \le A
\end{cases}
\]</span> where recruitment, <span class="math inline">\(R_s=0.5\)</span>, such that numbers are ‘per
recruit’. <span class="math inline">\(R_s\)</span> is a column vector of
recruits in the <span class="math inline">\(K\)</span> different length
classes, i,e.</p>
<p><span class="math display">\[
R_s = \begin{pmatrix}
\theta_{s,1} \\
\theta_{s,2} \\
\theta_{s,3} \\
\vdots \\
\theta_{s,K}
\end{pmatrix}
\]</span> The numbers of fish of sex <span class="math inline">\(s\)</span> are represented by a the following
number matrix,</p>
<p><span class="math display">\[
\textbf{N}_s = [N_{s,k,a}] = \begin{pmatrix}
N_{s,1,1} &amp; N_{s,1,2} &amp; \cdots &amp; N_{s,1,A-1} &amp; N_{s,1,A}
\\
N_{s,2,1} &amp; N_{s,2,2} &amp; \cdots &amp; N_{s,2,A-1} &amp; N_{s,2,A}
\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\
N_{s,K-1,1} &amp; N_{s,K-1,2} &amp; \cdots &amp; N_{s,K-1,A-1} &amp;
N_{s,K-1,A} \\
N_{s,K,1} &amp; N_{s,K,2} &amp; \cdots &amp; N_{s,K,A-1} &amp; N_{s,K,A}
\end{pmatrix}
\]</span> the elements of which (<span class="math inline">\(N_{s,k,a}\)</span>) are the numbers of fish of sex
<span class="math inline">\(s\)</span> in length class <span class="math inline">\(k\)</span> and age <span class="math inline">\(a\)</span>, in the population at equilibrium with
constant recruitment, mortality and growth. The number of fish of sex
<span class="math inline">\(s\)</span> in length class <span class="math inline">\(k\)</span> is thus</p>
<p><span class="math display">\[
N_{s,k} = \sum_{a=1}^A N_{s,k,a}
\]</span> Note, for functional hermaphrodites <span class="math inline">\(N_{s,k,a}\)</span> is modified such that the
numbers of each sex in length class <span class="math inline">\(k\)</span> honor the length-based sex-change
relationships. For protogynous hermaphrodites, the proportion of fish
that are males in length class <span class="math inline">\(k\)</span>
is</p>
<p><span class="math display">\[
\rho_{s=m,k} = \frac{P_{max,s=m}}{1 + \exp \left( -\ln 19 \frac{L_k -
L_{50}^\rho}{L_{95}^\rho - L_{50}^\rho} \right)}
\]</span> and (for protogynous hermaphrodites) the proportion of fish
that are females is</p>
<p><span class="math display">\[
\rho_{s=f,k} = 1 - \rho_{s=m,k}
\]</span> At the end of each model age step, the numbers of females
modified for expected sex ratio (for protogynous hermaphrodites) is</p>
<p><span class="math display">\[
N&#39;_{s,k,a} = \rho_{s,k} N_{s=f,k,a} + N_{s=m,k,a}
\]</span> The values of <span class="math inline">\(N_{s,k,a}\)</span>
are reset to <span class="math inline">\(N&#39;_{s,k,a}\)</span> at each
age step.</p>
</div>
<div id="yield-per-recruit---length-based-equilbrium-analysis-lbea" class="section level3">
<h3>Yield per recruit - length-based equilbrium analysis (LBEA)</h3>
<p>Retained catches of fish of sex <span class="math inline">\(s\)</span> in length class <span class="math inline">\(k\)</span> are calculated from the Baranov catch
equation, i.e. <span class="math display">\[
C_{s,k}^R = \frac{F_k^R}{Z_k} \left( 1 - \exp(-Z_k) \right) N_{s,k}
\]</span></p>
<p>Yield per recruit, <span class="math inline">\(YPR\)</span>, is
calculated as <span class="math display">\[
YPR = \sum_{s=f}^m \sum_{k=1}^K C_{s,k}^R W_{s,k}
\]</span> where <span class="math inline">\(K\)</span> donotes the
number of length classes considered by the model.</p>
</div>
<div id="spawning-potential-ratio---length-based-equilbrium-analysis-lbea" class="section level3">
<h3>Spawning potential ratio - length-based equilbrium analysis
(LBEA)</h3>
<p>Spawning biomass per recruit for sex <span class="math inline">\(s\)</span> when population is at equilibrium with
fully-selected fishing mortality, <span class="math inline">\(F\)</span>, is</p>
<p><span class="math display">\[
\Phi_{s,F} = \sum_{k=1}^K N_{s,k} W_{s,k} P_{s,k}
\]</span></p>
<p>The spawning potential ratio, for sex <span class="math inline">\(s\)</span> when the population is at equilibrium
with fully-selected fishing mortality, <span class="math inline">\(F\)</span>, is <span class="math display">\[
SPR_{s,F} = \frac{\Phi_{s,F}}{\Phi_{s,F=0}}
\]</span></p>
</div>
<div id="equilibrium-recruitment---length-or-age-based-per-equilibrium-analysis-lbea-or-abea" class="section level3">
<h3>Equilibrium recruitment - length or age-based per equilibrium
analysis (LBEA or ABEA)</h3>
<p>For gonochoristic species, the equilibrium level of Beverton-Holt
recruitment for the fished population, relative to that for the unfished
population (Mace and Doonan, 1988) is determined as <span class="math display">\[
R_{eq,F} = \frac{4h \Phi_{s=f,F} - (1 - h) \Phi_{s=f,F=0}}{5h - 0.2
\Phi_{s=f,F}}
\]</span> For hermaphroditic species, recruitment is calculated from
spawning biomass for combined sexes. For hermaphroditic species,
depending on user inputs, calculations for equilibrium recruitment can
be modified further to account for predicted effects of reduced male
spawning biomass on egg fertilisation rates. As fishing tends to be
focused towards capturing larger individuals, for protogynous (female to
male sex change) in particular, exploitation can potentially result in
reduced egg fertilisation rates due to limited sperm availability
associated with depletion of males. Following Brooks et al. (2008),
fertilisation rate at the current level of fishing pressure, <span class="math inline">\(\zeta\)</span> may be modelled as a function of
adult sex ratio,</p>
<p><span class="math display">\[
\zeta=\frac{4\kappa x}{(1-\kappa)+(5\kappa-1)x}
\]</span> where <span class="math inline">\(x\)</span> represents the
ratio of (i) the proportion of males to mature females in the fish
population (measured in terms of numbers) at the current estimated level
of fishing mortality to (ii) the proportion of males to mature females
in the unfished population. The value of <span class="math inline">\(x\)</span> thus represents a measure of male
depletion, which can range from 0 (fully depleted) to 1 (no depletion).
Note that the above relationship is similar to a Beverton-Holt stock
recruitment relationship and the effect of male depletion on
fertilisation rate is affected by a parameter <span class="math inline">\(\kappa\)</span>, analogous to the steepness
parameter this type of relationship (which can range from 0.2 to 1.0). A
high value for <span class="math inline">\(\kappa\)</span> means that
the stock is assumed to be able to be able to maintain high
fertilisation rates even when males are scarce. It is likely that group
spawning species will have a higher value of <span class="math inline">\(\kappa\)</span> than for pair spawning species
(Brooks et al., 2008). Specifying a value of 1 for <span class="math inline">\(\zeta\)</span> assumes no effect of male depletion
on egg fertilisation rate. In LBEA, equilibrium recruitment is taken as
the value for <span class="math inline">\(R_{eq}\)</span>, determined
from the relevant stock-recruitment relationship, multiplied by <span class="math inline">\(\zeta\)</span>. If a value for <span class="math inline">\(\kappa\)</span> is not specified, then <span class="math inline">\(R_{eq}\)</span> is determined from the mature
biomass for combined sexes, otherwise it is calculated based on mature
female biomass.</p>
</div>
<div id="equilbrium-catch-and-relative-spawning-biomass---length-or-age-based-per-equilibrium-analysis-lbea-or-abea" class="section level3">
<h3>Equilbrium catch and relative spawning biomass - length or age-based
per equilibrium analysis (LBEA or ABEA)</h3>
<p>The equilibrium level of catch, for the fished population may be
calculated as</p>
<p><span class="math display">\[
R_{eq,F} YPR
\]</span> The equilibrium level of spawning biomass for sex <span class="math inline">\(s\)</span>, for the fished population may be
calculated as</p>
<p><span class="math display">\[
B_{eq,s,F} = R_{eq,F} \Phi_{s,F}
\]</span> The equilibrium ratio of spawning biomass of sex <span class="math inline">\(s\)</span>, relative to the unfished level, is</p>
<p><span class="math display">\[
B_{rel,s,F} = \frac{B_{eq,s,F}}{\Phi_{s,F=0}}
\]</span></p>
</div>
<div id="calculation-of-biological-reference-points---age-and-length-based-per-equilibrium-analyses-lbea-and-abea" class="section level3">
<h3>Calculation of biological reference points - age and length-based
per equilibrium analyses (LBEA and ABEA)</h3>
<p>LBEA and ABEA both output the value of relative biomass <span class="math inline">\(B_{rel}\)</span> corresponding to the level at
which <span class="math inline">\(C_{eq}\)</span> is maximised (i.e. at
<span class="math inline">\(MSY\)</span>). The models also output <span class="math inline">\(F_{MSY}\)</span>, the (equilibrium) level of
fishing mortality expected to result in the stock being at <span class="math inline">\(B_{MSY}\)</span>. The models also output a
threshold level for <span class="math inline">\(B{rel}\)</span>,
corresponding to that at <span class="math inline">\(B_{MSY}\)</span>,
with the limit set to half this level, and a default target at 1.2 times
this level (or higher). Corresponding reference points for fishing
mortality (i.e. <span class="math inline">\(F_{targ}\)</span>, <span class="math inline">\(F_{thresh}\)</span> and <span class="math inline">\(F_{lim}\)</span>), for these biomass reference
levels are also outputted. Alternatively, for plotting and risk
calculations (see below), pre-specified ‘proxy’ values may be used, with
the limit set to <span class="math inline">\(B_{rel}=0.2\)</span>, the
threshold at <span class="math inline">\(B_{rel}=0.3\)</span> and target
at <span class="math inline">\(B_{rel}=0.4\)</span>. Use of
pre-specified proxy reference values (rather than calculated <span class="math inline">\(B_{MSY}\)</span> reference points) avoids the
issue of the reference levels being strongly affected by the assumed
value for the steepness parameter in the stock-recruitment
relationship.</p>
</div>
<div id="allowing-for-error-in-per-recruit-calculations---age-and-length-based-per-equilibrium-analyses-lbea-and-abea" class="section level3">
<h3>Allowing for error in per recruit calculations - age and
length-based per equilibrium analyses (LBEA and ABEA)</h3>
<p>LBEA and ABEA allow for incorporation uncertainty in estimates of
fishing mortality, natural mortality and steepness, assuming independent
normal or lognormal distributions for each of these parameters.
Following the recommendation of Hamel &amp; Cope (2022), for natural
mortality, the example code specifies a lognormal distribtuion, with
standard deviation value, in log space, of 0.31 (can be modified). For
fishing mortality, the standard deviation value can be derived from
outputs of catch curve analysis. Estimates of key outputs from per
recruit analysis, with uncertainty, are produced using parametric
sampling to produce a specified number (e.g. 500) of F, M and h values,
which are inputted into the deterministic per recruit equations
(i.e. within the CalcYPRAndSPRForFMort() function), to produce 500 sets
of estimated results of key parameters of interest. Lower and Upper 95%
confidence limits are taken as the 2.5 and 97.5 percentiles of the 500
estimates.</p>
<p>Note, it is also possible to incorporate other sources of
uncertainty, such as for growth and maturity curves, if estimates are
available for the parameters of each curve and variance-covariance
matrix for these relationships (such as are outputted by the
WAFishBiolgy R package). ‘Wrapper’ code, involving use of the
CalcYPRAndSPRForFMort() function for each set of input parameters, and
storing and analysing the outputs to produce confidence limits, can be
relatively easily implemented (outside the package).</p>
</div>
<div id="risk-calculations-and-associated-table-for-relative-biomass-estimates---age-and-length-based-per-equilibrium-analyses-lbea-and-abea" class="section level3">
<h3>Risk calculations and associated table for relative biomass
estimates - age and length-based per equilibrium analyses (LBEA and
ABEA)</h3>
<p>The function PlotPerRecruit_RiskMatrix_RelBiom()) is available to
calculate and plot risk assessment scores associated with estimates
relative biomass derived from incorporation of an estimate for fishing
mortality in per recruit analysis. The risk methodolgy (ISO 310000)
follows the consequence x likelihood approach used for Western
Australian fisheries, as described by Fletcher (2015). Outputs are
plotted as a risk table, with a risk level (negligible, low, medium,
high or severe) assigned to each consequence level (minor; B&gt;Targ;
moderate, Thresh&lt;B&lt;Targ; high, Lim&lt;B&lt;Thresh; or major,
B&lt;Lim), depending on the likelihood of that risk level (remote,
&lt;5%; unlikely, 5-20%; possible, 20-50%, likely, &gt;50%).</p>
</div>
<div id="calculation-of-prediction-intervals-displayed-for-growth-curves---length-based-per-equilibrium-analyses-lbea" class="section level3">
<h3>Calculation of prediction intervals displayed for growth curves -
length-based per equilibrium analyses (LBEA)</h3>
<p>The function PlotPerRecruitResults_LB() outputs diagnostic plots of
growth curves with calculated prediction intervals for lengths-at age,
derived using the value for the coefficient of variation (cv) inputted
by the user (assumed in the analysis to be constant across lengths) for
the specified growth curve. The prediction intervals are calculated
using a resampling approach. Specifically, for each of 10,000 females
and 10,000 males, a random length class is drawn, assuming a multinomial
distribution (i.e. using the rmultinom function() in R), based on the
expected proportions of fish in the fished population of sex <span class="math inline">\(s\)</span> in length class <span class="math inline">\(k\)</span> at age <span class="math inline">\(a\)</span>, calculated from the expected numbers,
<span class="math inline">\(N_{s,k,a}\)</span>. For each fish with a
randomly-assigned length class, a random value of length from the range
of possible lengths of fish within that length class is then drawn,
i.e. assuming the lengths of the fish within each length class have a
uniform distribution. The upper and lower prediction intervals for
length for sex <span class="math inline">\(s\)</span>, as shown on the
growth curve plots associated with the expected lengths at each age, are
taken as the 97.5 and 2.5 percentiles, respectively, of the 10,000
length values for that sex.</p>
</div>
<div id="calculation-of-expected-sizes-and-weights-of-fish-at-different-levels-of-fishing-mortality---length-based-equilibrium-analysis-lbea" class="section level3">
<h3>Calculation of expected sizes and weights of fish at different
levels of fishing mortality - length-based equilibrium analysis
(LBEA)</h3>
<p>The function() PlotPerRecruit_ExpCatchSizeDistns_LB provides plots of
expected mean sizes and weights of fish in catches, for females, males
and combined sexes, over a wide range of fishing mortality levels, with
associated 60 and 95 percent prediction intervals. The mean sizes and
weights of fish in catches at the value of fishing mortality inputted by
the user are also shown. Similar to above (previous heading), at each
value of fishing mortality, a resampling approach, using the rmultinom
function() in R, is used firstly to generate random length classes for
each of 10,000 females and 10,000 males, based on the expected
proportions of fish in expected retained catches of sex <span class="math inline">\(s\)</span> and length <span class="math inline">\(k\)</span>. These are calculated using <span class="math inline">\(C_{s,k}\)</span>, the expected numbers of fish sex
<span class="math inline">\(s\)</span> and length <span class="math inline">\(l\)</span> in retained catches. For each fish with
a randomly-assigned length class, a random value of length from the
range of possible lengths of fish within that length class is then
drawn, assuming the lengths of the fish within each length class have a
uniform distribution. The upper and lower prediction intervals
associated with the expected lengths of fish, are taken as the 97.5 and
2.5 percentiles, respectively, of the 10,000 values of length for each
sex. For each fish of sex <span class="math inline">\(s\)</span> with a
randomly generated length, its expected weight is calculated using the
specified weight-length relationship, given its sex. Upper and lower
prediction intervals for weight are calculated using the same approach
as for fish length.</p>
</div>
<div id="value-per-recruit-calculations---length-based-equilibrium-analysis-lbea" class="section level3">
<h3>Value per recruit calculations - length-based equilibrium analysis
(LBEA)</h3>
<p>Two routines, Get_Relative_Value_Per_Recruit_LB() and
PlotValuePerRecruitResults_LB() to extend calculations of the
above-described length-based per recruit methods, to undertake ‘value’-
(or ‘utility’-) per-recruit analysis (e.g. see Die et al., 1988; Zhai
&amp; Pauly, 2019). Value-per-recruit analysis considers that the value
of a fish to a fisher may differ according to fish size, e.g. commercial
fishers may receive a greater price per kg for fish of larger size, or
recreational fishers may place high value on ‘trophy-sized’ fish). This
analysis in L3Assess considers that the value of a fish (to a fisher)
varies in accordance with fish length and that i) there may be a minimum
size below which a fish has no value to a fisher (e.g. as it is below
the minimum legal length and is therefore discarded if caught) and ii)
above that length, value scales according fish length according to the
following relationship:</p>
<p><span class="math display">\[
\Lambda_l = \bigg(L_{\min}+((L-L_{min})^{\gamma}\bigg)/L
\]</span> where, <span class="math inline">\(\Lambda_l\)</span>, is a
measure of the value of a fish in length class <span class="math inline">\(l\)</span>, relative to the value accorded to a
fish of length <span class="math inline">\(L_{\min}\)</span>, which is
the minimum length of a fish to be considered to be of any value to a
fisher. <span class="math inline">\(\gamma\)</span> is a parameter
specified by the user, for scaling the ‘value’ of fish according to
their length. The value of <span class="math inline">\(L_{\min}\)</span>
is calculated according to <span class="math inline">\(W_{min}\)</span>,
a user specified value representing the minimum weight for a fish to be
considered of value (i.e. noting that fishers may be more familiar with
comparisons of fish of different weights). Specifically, <span class="math inline">\(L_{\min}\)</span> is calculated as</p>
<p><span class="math display">\[
L_{\min}=(W_{\min}/{a})^{1/b}
\]</span> where <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are parameters of a weight-length
relationship. For a given level of fishing mortality, the value of all
fish (of both sexes) in retained catches is calculated as</p>
<p><span class="math display">\[
X = \sum_lC_{l}W_{l}\Lambda_lR_{eq}
\]</span> Values of <span class="math inline">\(X\)</span> are
calculated for a wide range of fishing mortalities, and a search is
undertaken to identify the value of fishing mortality that maximises
<span class="math inline">\(X\)</span>. Unless the value of a fish
scales in proportion to fish weight (i.e. <span class="math inline">\(\gamma\)</span> is set to one), the optimum value
of fishing mortality from a value-per-recruit analysis is expected to be
less than from a yield-per-recruit analysis. Note also that the
calculations allow for potential fishing impacts on catch, i.e. through
impacting recruitment.</p>
</div>
<div id="apply-length-based-equilibrium-analysis-lbea" class="section level3">
<h3>Apply length-based equilibrium analysis (LBEA)</h3>
<p>Key functions relevant to applying this method are:<br />
CalcYPRAndSPRForFMort_LB()<br />
GetPerRecruitResults_LB()<br />
PlotPerRecruitResults_LB()<br />
PlotPerRecruit_Biom_no_err_LB()<br />
PlotPerRecruit_Yield_no_err_LB()<br />
PlotPerRecruit_Param_Err_Distns()<br />
GetPerRecruitResults_with_err_LB()<br />
PlotPerRecruit_Biom_with_err_LB()<br />
PlotPerRecruit_RiskMatrix_RelBiom()<br />
GetPerRecruitGrowthPredIntervals_LB()<br />
PlotPerRecruit_ExpCatchSizeDistns_LB()<br />
Get_Relative_Value_Per_Recruit_LB()<br />
PlotValuePerRecruitResults_LB()<br />
Refer to help files and example code, showing function inputs and
outputs.</p>
</div>
</div>
<div id="simulation-of-age-data-assuming-constant-mortality-and-recruitment" class="section level2">
<h2>Simulation of age data (assuming constant mortality and
recruitment)</h2>
<p>The package provides a basic procedure in the SimAgeFreqData()
function for simulating age frequency samples, based on the equations
provided above describing the age-based catch curve method with logistic
selectivity. Given a specified sample size, values for expected catch
proportions at age, <span class="math inline">\(\hat{P_a}\)</span>, an
age sample can be generated from a multinomial distribution, i.e. using
the rmultinom() function in R. This method for simulating age frequency
data is provided in code for several examples for applying age-based
catch curves. Note that these data generated for a stock assumed to at
equilibrium with respect to mortality and recruitment, assuming logistic
age-based selectivity.</p>
</div>
<div id="simulation-of-length-and-age-data-assuming-constant-mortality-and-recruitment" class="section level2">
<h2>Simulation of length and age data (assuming constant mortality and
recruitment)</h2>
<p>The function SimLenAndAgeFreqData() is provided for simulating length
and age data, based on the equations and assumptions of the ‘length and
age based catch curve model’. The function produces length frequency
samples of a specified sample size, given the expected proportion of
fish in each length class <span class="math inline">\(l\)</span>,
i.e. <span class="math inline">\(\hat{P}_l\)</span>, using the
rmultinom() function in R. An associated age frequency sample for each
length class <span class="math inline">\(l\)</span> is generated from
the expected, conditional age distributions for each length class, <span class="math inline">\(\hat{P}_{a|l}\)</span>, by applying the
rmultinom() function from within R. Note that these data generated for a
stock assumed to at equilibrium with respect to mortality and
recruitment, assuming logistic length-based selectivity (and allowing
for discarding, if specified).</p>
</div>
<div id="simulation-of-length-data-using-a-dynamic-length-structured-model" class="section level2">
<h2>Simulation of length data using a dynamic length-structured
model</h2>
<p>The function SimLenAndAgeFreqData_DynMod() is available for
simulating length data, allowing for constant or variable mortality,
and/or constant or variable recruitment, using a dynamic
length-structured model. This length-based uses outputs from the
extended, length-based per recruit analyses to calculate the stock
recruitment relationship and specify the initial population at fished
equilibrium.</p>
<div id="description-of-dynamic-length-structured-model-for-simulating-length-data" class="section level3">
<h3>Description of dynamic length-structured model for simulating length
data</h3>
<p>This dynamic length-structured simulation model generates synthetic
length data, allowing for variable recruitment (assuming, for this
study, constant mortality). The model takes outputs from LBEA and
combines these outputs with simulated annual recruitment trends (with
specified recruitment variation and associated autocorrelation). Data
are simulated for a specified number of years and length composition
data are generated for each year. The sample sizes for the simulated
length compositions were the same for each year. The length data are
generated assuming that the expected proportions of fish at length in
retained catches have a multinomial distribution. Note that this
analysis shares a number of equations with LBEA (e.g. growth and
survival matrices and associated equations) not repeated here. This
mathematical description of this model is now also available in the
supplementary material for Crisafulli et al (in review).</p>
<p>The initial level of recruitment generated (by LBEA) based on
equilibrium conditions with constant recruitment, mortality, and growth
of sex <span class="math inline">\(s\)</span> in year <span class="math inline">\(y=0\)</span> and length class <span class="math inline">\(j\)</span> is</p>
<p><span class="math display">\[
R_{s,y,j} =
\begin{cases}
\xi R_y \theta_{s,j} &amp; \text{if } s = f \\
(1 - \xi) R_y \theta_{s,j} &amp; \text{if } s = m
\end{cases}
\]</span> where <span class="math inline">\(R_y\)</span> is the initial
recruitment for the unfished population, <span class="math inline">\(\theta_{s,j}\)</span> is the proportion of age 1
recruits of sex <span class="math inline">\(s\)</span> in length class
<span class="math inline">\(k\)</span> and <span class="math inline">\(\xi\)</span> is the proportion of recruits that
are female. The numbers of fish of sex <span class="math inline">\(s\)</span> in year <span class="math inline">\(y\)</span> and length class <span class="math inline">\(j\)</span> relative to the number of recruits at
equilibrium in year <span class="math inline">\(y=0\)</span> is</p>
<p><span class="math display">\[
N_{s,y,a,j} =
\begin{cases}
R_{s,y,j} &amp; \text{if } a = 1 \\
\sum_{k=1}^K g_{s,j,k} S_{s,a-1,k} N_{s,y-1,a-1,k} &amp; \text{if } 1
&lt; a \le A
\end{cases}
\]</span> where <span class="math inline">\(g_{s,j,k}\)</span> is an
element of a sex-specific growth transition matrix, <span class="math inline">\(S_{s,a-1,k}\)</span> is the proportion surviving
of fish of sex <span class="math inline">\(s\)</span> at age <span class="math inline">\(a-1\)</span> in length class <span class="math inline">\(k\)</span> (see description of LBEA for more
detail). Summing over ages, the number of fish of sex <span class="math inline">\(s\)</span> in year <span class="math inline">\(y\)</span> and length class <span class="math inline">\(j\)</span> is</p>
<p><span class="math display">\[
N_{s,y,j} = \sum_{a=1}^A N_{s,y,a,j}
\]</span> and, summing of length classes, the number of fish of sex
<span class="math inline">\(s\)</span> in year <span class="math inline">\(y\)</span> is</p>
<p><span class="math display">\[
N_{s,y} = \sum_{j=1}^K N_{s,y,j}
\]</span> Allowing for recruitment variation, the standard deviation for
random, normally distributed errors, accounting for autocorrelation,
is</p>
<p><span class="math display">\[
\sigma_\epsilon = \sqrt{1 + A_R^2} \sigma_R
\]</span> where <span class="math inline">\(A_R^2\)</span> is the level
of autocorrelation between successive annual recruitment deviation
values, and <span class="math inline">\(\sigma_R\)</span> is the
standard deviation for recruitment deviations, in log space. The random
recruitment deviations are are assumed to be normally distributed,
i.e.</p>
<p><span class="math display">\[
\epsilon&#39;_y \sim N(0, \sigma_\epsilon^2)
\]</span> The random recruitment deviation (accounting for
autocorrelation) for year <span class="math inline">\(y\)</span> is</p>
<p><span class="math display">\[
\epsilon_y = A_R \epsilon_{y-1} + \epsilon&#39;_y
\]</span> The dynamic model assumes a Beverton-Holt stock-recruitment
relationship, with parameter <span class="math inline">\(\alpha\)</span></p>
<p><span class="math display">\[
\alpha = (B_{y=0}/R_{y=0}) \frac{1 - h}{4h}
\]</span> and <span class="math inline">\(\beta\)</span></p>
<p><span class="math display">\[
\beta = (h - 0.2)/(0.8h R_{y=0})
\]</span></p>
<p>The spawning biomass of fish of sex <span class="math inline">\(s\)</span> in year <span class="math inline">\(y\)</span> is</p>
<p><span class="math display">\[
B_{s,y} = \sum_{k=1}^K N_{s,y,k} P_{s,k} W_{s,k}
\]</span> Annual recruitment for the simulation projection years, when
the stock is not in equilibrium with respect to recruitment is
calculated as</p>
<p><span class="math display">\[
R_{y+1} = \frac{B_{s=f,y}}{\alpha + \beta B_{s=f,y}} \exp \left(
\epsilon_y - 0.5 \sigma_R^2 \right)
\]</span> Note, for hermaphroditic species unfished biomass is
calculated for combined sexes. The annual retained catch of fish of sex
<span class="math inline">\(s\)</span> in length class <span class="math inline">\(k\)</span>, in year <span class="math inline">\(y\)</span>, in numbers is determined as
follows.</p>
<p><span class="math display">\[
C_{s,y,k} = N_{s,y,k} \frac{F_{s,k}^R}{Z_{s,k}} \left( 1 -
\exp(-Z_{s,k}) \right)
\]</span> Note that, for the study of Crisafulli et al (2024), mortality
was assumed to be constant. Alternatively, using the function
SimExploitationHistory_DynMod(), a history of variable exploitation may
be specified. As with annual recruitment deviations (see above), values
of annual fishing mortality may varying around a specified trend
(e.g. initial increase, decrease then stabilisation at lower level),
using an AR-1 process.</p>
</div>
<div id="generating-simulated-annual-length-compositions-from-the-dynamic-length-structured-model" class="section level3">
<h3>Generating (simulated) annual length compositions from the dynamic
length-structured model</h3>
<p>Length frequency samples of a specified sample size for sex <span class="math inline">\(s\)</span> in year <span class="math inline">\(t\)</span>, are generated from the expected
proportions of such fish in that year in each length class <span class="math inline">\(l\)</span>, i.e. <span class="math inline">\(\hat{P}_{t,l}\)</span>, using the rmultinom()
function in R. The values of <span class="math inline">\(\hat{P_{t,l}}\)</span> are calculated as</p>
<p><span class="math display">\[
\hat{P}_{t,s,k}=C_{t,s,k}/\sum_{k=1}^{K}C_{t,s,k}
\]</span></p>
</div>
<div id="apply-routines-for-simulating-length-andor-age-data" class="section level3">
<h3>Apply routines for simulating length and/or age data</h3>
<p>Key functions relevant to applying this method are:
SimAgeFreqData()<br />
SimLenAndAgeFreqData()<br />
PlotSimLenAndAgeFreqData()<br />
SimExploitationHistory_DynMod()<br />
SimLenAndAgeFreqData_DynMod()</p>
</div>
</div>
<div id="references" class="section level2">
<h2>References:</h2>
<p>Beverton, R. J. H. &amp; Holt, S. J. (1957). On the Dynamics of
Exploited Fish Populations. Chapman and Hall, London.</p>
<p>Brooks, E. N., Shertzer, K. W., Gedamke, T. &amp; Vaughan, D. S.
(2008). Stock assessment of protogynous fish: evaluating measures of
spawning biomass used to estimate biological reference points. Fisheries
Bulletin 106, 12-23.</p>
<p>Chapman, D. G., and D. S. Robson. (1960). The analysis of a catch
curve. Biometrics 16, 354-368.</p>
<p>Crisafulli, B., Hesp, S. A., Afrifa-Yamoah, E., Mueller, U., Ryan,
K., Fairclough, D., Hall, N. &amp; Lo, J. (in review). Accounting for
post-release mortality in data-limited, length-based assessments of four
demersal fishes with varying life histories. Fisheries Research.</p>
<p>Die, D. J., Restrepo, V. R. &amp; Hoenig, J. M. (1988).
Utility-per-recruit modeling: a neglected concept. Transactions of the
American Fisheries Society 117, 274-281.</p>
<p>Evans-Powell, R. T., Hesp, S. A., Denham, A. &amp; Beckley, L. E.
(2024). Implications of big, old, fat, fecund, female fish (BOFFFFs) for
the reproductive potential of a demersal teleost stock. Fisheries
Research 272. Art. 106934.</p>
<p>Fairclough, D.V., Hesp, S.A., Denham, A., Fisher, E.A., Marks, R.,
Ryan, K.L., Lek, E., Allen, R. &amp; Crisafulli, B.M. 2021. 2021
assessment of the status of the West Coast Demersal Scalefish Resource.
Fisheries Research Report No. 316 Department of Primary Industries and
Regional Development, Western Australia. 158 pp.</p>
<p>Fletcher, W. J. (2015). Review and refinement of an existing
qualitative risk assessment method for application within an
ecosystem-based management framework. ICES Journal of Marine Science
(2015), 72(3), 1043–1056. <a href="doi:10.1093/icesjms/fsu142" class="uri">doi:10.1093/icesjms/fsu142</a>.</p>
<p>Hamel, O. S. &amp; Cope, J. M. (2022). Development and considerations
for application of a longevity-based prior for the natural mortality
rate. Fisheries Research 256 (2022) 106477.</p>
<p>Hoenig, J. M. (1983). Empirical use of longevity data to estimate
mortality rates. Fishery Bulletin 82, 898–903.</p>
<p>Kirkwood, G. P. &amp; Walker, T. I. (1986). Gill net mesh
selectivities for gummy shark, Mustelus antarcticus Günther, taken in
south-eastern Australia. Australian Journal of Marine and Freshwater
Research, 37, 689-697.Kurup, R. G., &amp; Hamilton, D. P. (2002).</p>
<p>Mace, P. M. &amp; Doonan, I. J. (1988). A Generalised Bioeconomic
Simulation Model for Fish Population Dynamics. MAFFish, NZ Ministry of
Agriculture and Fisheries, Wellington, New Zealand.</p>
<p>Pauly, D. (1990). Length-converted catch curves and the seasonal
growth curve of fishes. Fishbyte 8(3), 24-29.</p>
<p>Pauly, D., Moreau, J. &amp; Abad, N. (1995). Comparison of
age-stuctured and length-converted catch curves of brown trout Salmo
trutta in two French rivers. Fisheries Research 22, 197-204.</p>
<p>Piner, K. R., Lee, H.-H., Maunder, M. N. (2016). Evaluation of using
random-at-length observations and an equilibrium approximation of the
population age structure in fitting the von Bertalanffy growth function.
Fisheries Research 180, 128-137.</p>
<p>Punt, A.E., Garratt, P.A., Govender, A., 1993. On an approach for
applying per-recruit methods to a protogynous hermaphrodite, with an
illustration for the slinger Chrysoblephus puniceus (Pisces: Sparidae).
Afr. J. Mar. Sci.13, 109–119. <a href="https://doi.org/10.2989/025776193784287293" class="uri">https://doi.org/10.2989/025776193784287293</a></p>
<p>Punt, A. E., Kennedy, R. B. &amp; Frusher, S. D. (1997). Estimating
the size transition matrix for Tasmanian rock lobster, Jasus edwardsii.
Marine and Freshwater Research 48, 981-992.</p>
<p>Ricker,W. E. 1954. Stock and recruitment. Journal of the Fisheries
Research Board of Canada 11, 559–623.</p>
<p>Shertzer, K.W., Williams, E.H. &amp; Sagarese, S.R. (2022). Modeling
discards in stock assessments: red grouper Epinephelus morio in the U.S.
Gulf of Mexico. Fishes 2022, 7(1), 7. Doi.org/10.3390/fishes7010007.</p>
<p>Smith, M. W., Then, A. Y., Wor, C., Ralph, G., Pollock, K. H. &amp;
Hoenig, J. M. (2012) Recommendations for Catch-Curve Analysis, North
American Journal of Fisheries Management, 32(5), 956-967.</p>
<p>Thorson, J. T., Johnson, K. F., Methot, R. D. &amp; Taylor, I. G.
Model-based estimates of effective sample size in stock assessment
models using the Dirichlet-multinomial distribution. Fisheries Research
192, 84-93. <a href="http://dx.doi.org/10.1016/j.fishres.2016.06.005" class="uri">http://dx.doi.org/10.1016/j.fishres.2016.06.005</a>.</p>
<p>Wakefield, C. B., Williams, A. J., Fisher, E. A., Hall, N. G., Hesp,
S. A., Halafihi, T., Kaltavara, J., Vourey, E., Taylor, B. M., O’Malley,
J. M., Nicol, S. J., Wise, B. W. &amp; Newman, S. J. (2020). Variations
in life history characteristics of the deep-water giant ruby snapper
(Etelis sp.) between the Indian and Pacific Oceans and application of a
data-poor assessment. Fisheries Research 230. Art. 105651.</p>
<p>Zhai, L. &amp; Pauly, D. (2019). Yield-per-Recruit,
Utility-per-Recruit, and Relative Biomass of 21 Exploited Fish Species
in China’s Coastal Seas. Frontiers of Marine Science, 6. Art. 724. <a href="https://doi.org/10.3389/fmars.2019.00724" class="uri">https://doi.org/10.3389/fmars.2019.00724</a>.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
